User:     PSEUDOSTUDENT, MATHS
Automatic Magma log submission from teaching laboratory
Date: 19-08-13  03:11 PM
Loading "/users/ugrad/m2068/magma/MATH2068/MagmaProcedures.txt"
(Magma functions defined for use in MATH2068/2988)
Log file: Mon19Aug.log
seed:  1427546770 0
> load "tut4data.txt";
Loading "/users/ugrad/m2068/magma/MATH2068/tut4data.txt"
> Type(ct1);
CryptTxt
> sct1:=String(ct1);
> Type(sct1);
MonStgElt
> sct2:=String(ct2);
> sct3:=String(ct3);
> sct4:=String(ct4);
> sct5:=String(ct5);
> sct6:=String(ct6);
> sct7:=String(ct7);
> CoincidenceIndex(sct1);
0.0694965088969106128825423590718
> CoincidenceIndex(sct2);
0.0415879787948780874621427836594
> CoincidenceIndex(sct3);
0.0416745922033904428145469104980
> CoincidenceIndex(sct4);
0.0652012312147048057406882815071
> CoincidenceIndex(sct5);
0.0407652125459580513021170486970
> CoincidenceIndex(sct6);
0.0651359214179901685384520145412
> CoincidenceIndex(sct7);
0.0650262272930852557825298140937
> /*
> For substitution ciphers and transposition ciphers the ciphertext will give the same
> value of the CI as the plaintext. This will usually be at least 0.06 and less than 0.07,
> although in an earlier tutorial we met some plaintext with a CI very slightly less
> than 0.06. Vigenère enciphered ciphertexts give a substantially lower CI: usually less
> than 0.05.
> It looks as though ct1, ct4, ct6 and ct7 are the ones that came from substitution or
> transposition ciphers, while ct2, ct3 and ct5 must be the Vigenère ones.
> */
>
> /*
> Now I've used the javascript Vigenere key finder to find that the keys
> for deciphering ct2, ct3 and ct5 are, respectively, LIZECR, HBRNPKDH and IOAQSNFANY.
> */
> V2:=VigenereCryptosystem(6);
> k2:=V2!"LIZECR";
> Enciphering(k2,Encoding(V2,sct2));
THEREWASONCEANEMPERORWHOHADAHORSESHODWITHGOLDHEHADAGOLDENSHOEONEACHFOOTANDWHYWA\
STHISHEWASABEAUTIFULCREATUREWITHSLENDERLEGSBRIGHTINTELLIGENTEYESANDAMANETHATHUN\
GDOWNOVERHISNECKLIKEAVEILHEHADCARRIEDHISMASTERTHROUGHFIREANDSMOKEINTHEBATTLEFIE\
LDWITHTHEBULLETSWHISTLINGROUNDHIMHEHADKICKEDANDBITTENANDTAKENPARTINTHEFIGHTWHEN\
THEENEMYADVANCEDANDWITHHISMASTERONHISBACKHEHADDASHEDOVERTHEFALLENFOEANDSAVEDTHE\
GOLDENCROWNANDTHEEMPERORSLIFEWHICHWASOFMOREVALUETHANTHEBRIGHTESTGOLDTHISISTHERE\
ASONOFTHEEMPERORSHORSEWEARINGGOLDENSHOESABEETLECAMECREEPINGFORTHFROMTHESTABLEWH\
ERETHEFARRIERHADBEENSHOEINGTHEHORSEGREATONESFIRSTOFCOURSESAIDHEANDTHENTHELITTLE\
ONESBUTSIZEISNOTALWAYSAPROOFOFGREATNESSHESTRETCHEDOUTHISTHINLEGASHESPOKEANDPRAY\
WHATDOYOUWANTASKEDTHEFARRIERGOLDENSHOESREPLIEDTHEBEETLEWHYYOUMUSTBEOUTOFYOURSEN\
SESCRIEDTHEFARRIERGOLDENSHOESFORYOUINDEEDYESCERTAINLYGOLDENSHOESREPLIEDTHEBEETL\
EAMINOTJUSTASGOODASTHATGREATCREATUREYONDERWHOISWAITEDUPONANDBRUSHEDANDHASFOODAN\
DDRINKPLACEDBEFOREHIMANDDONTIBELONGTOTHEROYALSTABLESBUTWHYDOESTHEHORSEHAVEGOLDE\
NSHOESASKEDTHEFARRIEROFCOURSEYOUUNDERSTANDTHEREASONUNDERSTANDWELLIUNDERSTANDTHA\
TITISAPERSONALSLIGHTTOMECRIEDTHEBEETLEITISDONETOANNOYMESOIINTENDTOGOOUTINTOTHEW\
ORLDANDSEEKMYFORTUNEGOALONGWITHYOUSAIDTHEFARRIERYOUREARUDEFELLOWCRIEDTHEBEETLEA\
SHEWALKEDOUTOFTHESTABLEANDTHENHEFLEWFORASHORTDISTANCETILLHEFOUNDHIMSELFINABEAUT\
IFULFLOWERGARDENALLFRAGRANTWITHROSESANDLAVENDERTHELADYBIRDSWITHREDANDBLACKSHELL\
SONTHEIRBACKSANDDELICATEWINGSWEREFLYINGABOUTANDONEOFTHEMSAIDISITNOTSWEETANDLOVE\
LYHEREOHHOWBEAUTIFULEVERYTHINGISIAMACCUSTOMEDTOBETTERTHINGSSAIDTHEBEETLEDOYOUCA\
LLTHISBEAUTIFULWHYTHEREISNOTEVENADUNGHEAPTHENHEWENTONANDUNDERTHESHADOWOFALARGEH\
AYSTACKHEFOUNDACATERPILLARCRAWLINGALONGHOWBEAUTIFULTHISWORLDISSAIDTHECATERPILLA\
RTHESUNISSOWARMIQUITEENJOYITANDSOONISHALLGOTOSLEEPANDDIEASTHEYCALLITBUTISHALLWA\
KEUPWITHBEAUTIFULWINGSTOFLYWITHLIKEABUTTERFLYHOWCONCEITEDYOUAREEXCLAIMEDTHEBEET\
LEFLYABOUTASABUTTERFLYINDEEDWHATOFTHATIHAVECOMEOUTOFTHEEMPERORSSTABLEANDNOONETH\
ERENOTEVENTHEEMPERORSHORSEWHOINFACTWEARSMYCASTOFFGOLDENSHOESHASANYIDEAOFFLYINGE\
XCEPTINGMYSELFTOHAVEWINGSANDFLYWHYICANDOTHATALREADYANDSOSAYINGHESPREADHISWINGSA\
NDFLEWAWAYIDONTWANTTOBEDISGUSTEDHESAIDTOHIMSELFANDYETICANTHELPITSOONAFTERHEFELL\
DOWNUPONANEXTENSIVELAWNANDFORATIMEPRETENDEDTOSLEEPBUTATLASTFELLASLEEPINEARNESTS\
UDDENLYAHEAVYSHOWEROFRAINCAMEFALLINGFROMTHECLOUDSTHEBEETLEWOKEUPWITHTHENOISEAND\
WOULDHAVEBEENGLADTOCREEPINTOTHEEARTHFORSHELTERBUTHECOULDNOTHEWASTUMBLEDOVERANDO\
VERWITHTHERAINSOMETIMESSWIMMINGONHISSTOMACHANDSOMETIMESONHISBACKANDASFORFLYINGT\
HATWASOUTOFTHEQUESTIONHEBEGANTODOUBTWHETHERHESHOULDESCAPEWITHHISLIFESOHEREMAINE\
DQUIETLYLYINGWHEREHEWASAFTERAWHILETHEWEATHERCLEAREDUPALITTLEANDTHEBEETLEWASABLE\
TORUBTHEWATERFROMHISEYESANDLOOKABOUTHIMHESAWSOMETHINGGLEAMINGANDHEMANAGEDTOMAKE\
HISWAYUPTOITITWASLINENWHICHHADBEENLAIDTOBLEACHONTHEGRASSHECREPTINTOAFOLDOFTHEDA\
MPLINENWHICHCERTAINLYWASNOTSOCOMFORTABLEAPLACETOLIEINASTHEWARMSTABLEBUTTHEREWAS\
NOTHINGBETTERSOHEREMAINEDLYINGTHEREFORAWHOLEDAYANDNIGHTANDTHERAINKEPTONALLTHETI\
METOWARDSMORNINGHECREPTOUTOFHISHIDINGPLACEFEELINGINAVERYBADTEMPERWITHTHECLIMATE\
TWOFROGSWERESITTINGONTHELINENANDTHEIRBRIGHTEYESACTUALLYGLISTENEDWITHPLEASUREWON\
DERFULWEATHERTHISCRIEDONEOFTHEMANDSOREFRESHINGTHISLINENHOLDSTHEWATERTOGETHERSOB\
EAUTIFULLYTHATMYHINDLEGSQUIVERASIFIWEREGOINGTOSWIMISHOULDLIKETOKNOWSAIDANOTHERI\
FTHESWALLOWWHOFLIESSOFARINHERMANYJOURNEYSTOFOREIGNLANDSEVERMETWITHABETTERCLIMAT\
ETHANTHISWHATDELICIOUSMOISTUREITISASPLEASANTASLYINGINAWETDITCHIAMSUREANYONEWHOD\
OESNOTENJOYTHISHASNOLOVEFORHISFATHERLANDHAVEYOUEVERBEENINTHEEMPERORSSTABLEASKED\
THEBEETLETHERETHEMOISTUREISWARMANDREFRESHINGTHATSTHECLIMATEFORMEBUTICOULDNOTTAK\
EITWITHMEONMYTRAVELSISTHERENOTEVENADUNGHILLHEREINTHISGARDENWHEREAPERSONOFRANKLI\
KEMYSELFCOULDTAKEUPHISABODEANDFEELATHOMEBUTTHEFROGSEITHERDIDNOTORWOULDNOTUNDERS\
TANDHIMINEVERASKAQUESTIONTWICESAIDTHEBEETLEAFTERHEHADASKEDTHISONETHREETIMESANDR\
ECEIVEDNOANSWERTHENHEWENTONALITTLEFARTHERANDSTUMBLEDAGAINSTAPIECEOFBROKENCROCKE\
RYWAREWHICHCERTAINLYOUGHTNOTTOHAVEBEENLYINGTHEREBUTASITWASTHEREITFORMEDAGOODSHE\
LTERAGAINSTWINDANDWEATHERTOSEVERALFAMILIESOFEARWIGSWHODWELTINITTHEIRREQUIREMENT\
SWERENOTMANYTHEYWEREVERYSOCIABLEANDFULLOFAFFECTIONFORTHEIRCHILDRENSOMUCHSOTHATE\
ACHMOTHERCONSIDEREDHEROWNCHILDTHEMOSTBEAUTIFULANDCLEVEROFTHEMALLOURDEARSONHASEN\
GAGEDHIMSELFSAIDONEMOTHERDEARINNOCENTBOYHISGREATESTAMBITIONISTHATHEMAYONEDAYCRE\
EPINTOACLERGYMANSEARTHATISAVERYARTLESSANDLOVEABLEWISHANDBEINGENGAGEDWILLKEEPHIM\
STEADYWHATHAPPINESSFORAMOTHEROURSONSAIDANOTHERHADSCARCELYCREPTOUTOFTHEEGGWHENHE\
WASOFFONHISTRAVELSHEISALLLIFEANDSPIRITSIEXPECTHEWILLWEAROUTHISHORNSWITHRUNNINGH\
OWCHARMINGTHISISFORAMOTHERISITNOTMRBEETLEFORSHEKNEWTHESTRANGERBYHISHORNYCOATYOU\
AREBOTHQUITERIGHTSAIDHESOTHEYBEGGEDHIMTOWALKINTHATISTOCOMEASFARASHECOULDUNDERTH\
EBROKENPIECEOFEARTHENWARENOWYOUSHALLALSOSEEMYLITTLEEARWIGSSAIDATHIRDANDAFOURTHM\
OTHERTHEYARELOVELYLITTLETHINGSANDHIGHLYAMUSINGTHEYARENEVERILLBEHAVEDEXCEPTWHENT\
HEYAREUNCOMFORTABLEINTHEIRINSIDEWHICHUNFORTUNATELYOFTENHAPPENSATTHEIRAGETHUSEAC\
HMOTHERSPOKEOFHERBABYANDTHEIRBABIESTALKEDAFTERTHEIROWNFASHIONANDMADEUSEOFTHELIT\
TLENIPPERSTHEYHAVEINTHEIRTAILSTONIPTHEBEARDOFTHEBEETLETHEYAREALWAYSBUSYABOUTSOM\
ETHINGTHELITTLEROGUESSAIDTHEMOTHERBEAMINGWITHMATERNALPRIDEBUTTHEBEETLEFELTITABO\
REANDHETHEREFOREINQUIREDTHEWAYTOTHENEARESTDUNGHEAPTHATISQUITEOUTINTHEGREATWORLD\
ONTHEOTHERSIDEOFTHEDITCHANSWEREDANEARWIGIHOPENONEOFMYCHILDRENWILLEVERGOSOFARITW\
OULDBETHEDEATHOFMEBUTISHALLTRYTOGETSOFARSAIDTHEBEETLEANDHEWALKEDOFFWITHOUTTAKIN\
GANYFORMALLEAVEWHICHISCONSIDEREDAPOLITETHINGTODOWHENHEARRIVEDATTHEDITCHHEMETSEV\
ERALFRIENDSALLTHEMBEETLESWELIVEHERETHEYSAIDANDWEAREVERYCOMFORTABLEMAYWEASKYOUTO\
STEPDOWNINTOTHISRICHMUDYOUMUSTBEFATIGUEDAFTERYOURJOURNEYCERTAINLYSAIDTHEBEETLEI\
SHALLBEMOSTHAPPYIHAVEBEENEXPOSEDTOTHERAINANDHAVEHADTOLIEUPONLINENANDCLEANLINESS\
ISATHINGTHATGREATLYEXHAUSTSMEIHAVEALSOPAINSINONEOFMYWINGSFROMSTANDINGINTHEDRAUG\
HTUNDERAPIECEOFBROKENCROCKERYITISREALLYQUITEREFRESHINGTOBEWITHONESOWNKINDREDAGA\
INPERHAPSYOUCAMEFROMADUNGHEAPOBSERVEDTHEOLDESTOFTHEMNOINDEEDICAMEFROMAMUCHGRAND\
ERPLACEREPLIEDTHEBEETLEICAMEFROMTHEEMPERORSSTABLEWHEREIWASBORNWITHGOLDENSHOESON\
MYFEETIAMTRAVELLINGONASECRETEMBASSYBUTYOUMUSTNOTASKMEANYQUESTIONSFORICANNOTBETR\
AYMYSECRETTHENTHEBEETLESTEPPEDDOWNINTOTHERICHMUDWHERESATTHREEYOUNGLADYBEETLESWH\
OTITTEREDBECAUSETHEYDIDNOTKNOWWHATTOSAYNONEOFTHEMAREENGAGEDYETSAIDTHEIRMOTHERAN\
DTHEBEETLEMAIDENSTITTEREDAGAINTHISTIMEQUITEINCONFUSIONIHAVENEVERSEENGREATERBEAU\
TIESEVENINTHEROYALSTABLESEXCLAIMEDTHEBEETLEWHOWASNOWRESTINGHIMSELFDONTSPOILMYGI\
RLSSAIDTHEMOTHERANDDONTTALKTOTHEMPRAYUNLESSYOUHAVESERIOUSINTENTIONSBUTOFCOURSET\
HEBEETLESINTENTIONSWERESERIOUSANDAFTERAWHILEOURFRIENDWASENGAGEDTHEMOTHERGAVETHE\
MHERBLESSINGANDALLTHEOTHERBEETLESCRIEDHURRAHIMMEDIATELYAFTERTHEBETROTHALCAMETHE\
MARRIAGEFORTHEREWASNOREASONTODELAYTHEFOLLOWINGDAYPASSEDVERYPLEASANTLYANDTHENEXT\
WASTOLERABLYCOMFORTABLEBUTONTHETHIRDITBECAMENECESSARYFORHIMTOTHINKOFGETTINGFOOD\
FORHISWIFEANDPERHAPSFORCHILDRENIHAVEALLOWEDMYSELFTOBETAKENINSAIDOURBEETLETOHIMS\
ELFANDNOWTHERESNOTHINGTOBEDONEBUTTOTAKETHEMININRETURNNOSOONERSAIDTHANDONEAWAYHE\
WENTANDSTAYEDAWAYALLDAYANDALLNIGHTANDHISWIFEREMAINEDBEHINDAFORSAKENWIDOWOHSAIDT\
HEOTHERBEETLESTHISFELLOWTHATWEHAVERECEIVEDINTOOURFAMILYISNOTHINGBUTACOMPLETEVAG\
ABONDHEHASGONEAWAYANDLEFTHISWIFEABURDENUPONOURHANDSWELLSHECANBEUNMARRIEDAGAINAN\
DREMAINHEREWITHMYOTHERDAUGHTERSSAIDTHEMOTHERFIEONTHEVILLAINTHATFORSOOKHERINTHEM\
EANTIMETHEBEETLEWHOHADSAILEDACROSSTHEDITCHONACABBAGELEAFHADBEENJOURNEYINGONTHEO\
THERSIDEINTHEMORNINGTWOPERSONSCAMEUPTOTHEDITCHWHENTHEYSAWHIMTHEYTOOKHIMUPANDTUR\
NEDHIMOVERANDOVERLOOKINGVERYLEARNEDALLTHETIMEESPECIALLYONEWHOWASABOYALLAHSEESTH\
EBLACKBEETLEINTHEBLACKSTONEANDTHEBLACKROCKISNOTTHATWRITTENINTHEKORANHEASKED
> V3:=VigenereCryptosystem(8);
> k3:=V3!"HBRNPKDH";
> Enciphering(k3,Encoding(V3,sct3));
IWILLTELLYOUASTORYTHATWASTOLDMEWHENIWASALITTLEBOYEVERYTIMEITHOUGHTOFTHISSTORYIT\
SEEMEDTOMEMOREANDMORECHARMINGFORITISWITHSTORIESASITISWITHMANYPEOPLETHEYBECOMEBE\
TTERASTHEYGROWOLDERIHAVENODOUBTTHATYOUHAVEBEENINTHECOUNTRYANDSEENAVERYOLDFARMHO\
USEWITHATHATCHEDROOFANDMOSSESANDSMALLPLANTSGROWINGWILDUPONITTHEREISASTORKSNESTO\
NTHERIDGEOFTHEGABLEFORWECANNOTDOWITHOUTTHESTORKTHEWALLSOFTHEHOUSEARESLOPINGANDT\
HEWINDOWSARELOWANDONLYONEOFTHELATTERISMADETOOPENTHEBAKINGOVENSTICKSOUTOFTHEWALL\
LIKEAGREATKNOBANELDERTREEHANGSOVERTHEPALINGSANDBENEATHITSBRANCHESATTHEFOOTOFTHE\
PALINGISAPOOLOFWATERINWHICHAFEWDUCKSAREDISPORTINGTHEMSELVESTHEREISAYARDDOGTOOWH\
OBARKSATALLCORNERSJUSTSUCHAFARMHOUSEASTHISSTOODINACOUNTRYLANEANDINITDWELTANOLDC\
OUPLEAPEASANTANDHISWIFESMALLASTHEIRPOSSESSIONSWERETHEYHADONEARTICLETHEYCOULDNOT\
DOWITHOUTANDTHATWASAHORSEWHICHCONTRIVEDTOLIVEUPONTHEGRASSWHICHITFOUNDBYTHESIDEO\
FTHEHIGHROADTHEOLDPEASANTRODEINTOTHETOWNUPONTHISHORSEANDHISNEIGHBORSOFTENBORROW\
EDITOFHIMANDPAIDFORTHELOANOFITBYRENDERINGSOMESERVICETOTHEOLDCOUPLEAFTERATIMETHE\
YTHOUGHTITWOULDBEASWELLTOSELLTHEHORSEOREXCHANGEITFORSOMETHINGWHICHMIGHTBEMOREUS\
EFULTOTHEMBUTWHATMIGHTTHISSOMETHINGBEYOULLKNOWBESTOLDMANSAIDTHEWIFEITISFAIRDAYT\
ODAYSORIDEINTOTOWNANDGETRIDOFTHEHORSEFORMONEYORMAKEAGOODEXCHANGEWHICHEVERYOUDOW\
ILLBERIGHTTOMESORIDETOTHEFAIRANDSHEFASTENEDHISNECKERCHIEFFORHIMFORSHECOULDDOTHA\
TBETTERTHANHECOULDANDSHECOULDALSOTIEITVERYPRETTILYINADOUBLEBOWSHEALSOSMOOTHEDHI\
SHATROUNDANDROUNDWITHTHEPALMOFHERHANDANDGAVEHIMAKISSTHENHERODEAWAYUPONTHEHORSET\
HATWASTOBESOLDORBARTEREDFORSOMETHINGELSEYESTHEOLDMANKNEWWHATHEWASABOUTTHESUNSHO\
NEWITHGREATHEATANDNOTACLOUDWASTOBESEENINTHESKYTHEROADWASVERYDUSTYFORANUMBEROFPE\
OPLEALLGOINGTOTHEFAIRWEREDRIVINGRIDINGORWALKINGUPONITTHEREWASNOSHELTERANYWHEREF\
ROMTHEHOTSUNSHINEAMONGTHERESTAMANCAMETRUDGINGALONGANDDRIVINGACOWTOTHEFAIRTHECOW\
WASASBEAUTIFULACREATUREASANYCOWCOULDBESHEGIVESGOODMILKIAMCERTAINSAIDTHEPEASANTT\
OHIMSELFTHATWOULDBEAVERYGOODEXCHANGETHECOWFORTHEHORSEHALLOTHEREYOUWITHTHECOWHES\
AIDITELLYOUWHATIDARESAYAHORSEISOFMOREVALUETHANACOWBUTIDONTCAREFORTHATACOWWILLBE\
MOREUSEFULTOMESOIFYOULIKEWELLEXCHANGETOBESUREIWILLSAIDTHEMANACCORDINGLYTHEEXCHA\
NGEWASMADEANDASTHEMATTERWASSETTLEDTHEPEASANTMIGHTHAVETURNEDBACKFORHEHADDONETHEB\
USINESSHECAMETODOBUTHAVINGMADEUPHISMINDTOGOTOTHEFAIRHEDETERMINEDTODOSOIFONLYTOH\
AVEALOOKATITSOONHEWENTTOTHETOWNWITHHISCOWLEADINGTHEANIMALHESTRODEONSTURDILYANDA\
FTERASHORTTIMEOVERTOOKAMANWHOWASDRIVINGASHEEPITWASAGOODFATSHEEPWITHAFINEFLEECEO\
NITSBACKISHOULDLIKETOHAVETHATFELLOWSAIDTHEPEASANTTOHIMSELFTHEREISPLENTYOFGRASSF\
ORHIMBYOURPALINGSANDINTHEWINTERWECOULDKEEPHIMINTHEROOMWITHUSPERHAPSITWOULDBEMOR\
EPROFITABLETOHAVEASHEEPTHANACOWSHALLIEXCHANGETHEMANWITHTHESHEEPWASQUITEREADYAND\
THEBARGAINWASQUICKLYMADEANDTHENOURPEASANTCONTINUEDHISWAYONTHEHIGHROADWITHHISSHE\
EPSOONAFTERTHISHEOVERTOOKANOTHERMANWHOHADCOMEINTOTHEROADFROMAFIELDANDWASCARRYIN\
GALARGEGOOSEUNDERHISARMWHATAHEAVYCREATUREYOUHAVETHERESAIDTHEPEASANTITHASPLENTYO\
FFEATHERSANDPLENTYOFFATANDWOULDLOOKWELLTIEDTOASTRINGORPADDLINGINTHEWATERATOURPL\
ACETHATWOULDBEVERYUSEFULTOMYOLDWOMANSHECOULDMAKEALLSORTSOFPROFITSOUTOFITHOWOFTE\
NSHEHASSAIDIFNOWWEONLYHADAGOOSENOWHEREISANOPPORTUNITYANDIFPOSSIBLEIWILLGETITFOR\
HERSHALLWEEXCHANGEIWILLGIVEYOUMYSHEEPFORYOURGOOSEANDTHANKSINTOTHEBARGAINTHEOTHE\
RHADNOTTHELEASTOBJECTIONANDACCORDINGLYTHEEXCHANGEWASMADEANDOURPEASANTBECAMEPOSS\
ESSOROFTHEGOOSEBYTHISTIMEHEHADARRIVEDVERYNEARTHETOWNTHECROWDONTHEHIGHROADHADBEE\
NGRADUALLYINCREASINGANDTHEREWASQUITEARUSHOFMENANDCATTLETHECATTLEWALKEDONTHEPATH\
ANDBYTHEPALINGSANDATTHETURNPIKEGATETHEYEVENWALKEDINTOTHETOLLKEEPERSPOTATOFIELDW\
HEREONEFOWLWASSTRUTTINGABOUTWITHASTRINGTIEDTOITSLEGFORFEARITSHOULDTAKEFRIGHTATT\
HECROWDANDRUNAWAYANDGETLOSTTHETAILFEATHERSOFTHEFOWLWEREVERYSHORTANDITWINKEDWITH\
BOTHITSEYESANDLOOKEDVERYCUNNINGASITSAIDCLUCKCLUCKWHATWERETHETHOUGHTSOFTHEFOWLAS\
ITSAIDTHISICANNOTTELLYOUBUTDIRECTLYOURGOODMANSAWITHETHOUGHTWHYTHATSTHEFINESTFOW\
LIEVERSAWINMYLIFEITSFINERTHANOURPARSONSBROODHENUPONMYWORDISHOULDLIKETOHAVETHATF\
OWLFOWLSCANALWAYSPICKUPAFEWGRAINSTHATLIEABOUTANDALMOSTKEEPTHEMSELVESITHINKITWOU\
LDBEAGOODEXCHANGEIFICOULDGETITFORMYGOOSESHALLWEEXCHANGEHEASKEDTHETOLLKEEPEREXCH\
ANGEREPEATEDTHEMANWELLITWOULDNOTBEABADTHINGANDSOTHEYMADEANEXCHANGETHETOLLKEEPER\
ATTHETURNPIKEGATEKEPTTHEGOOSEANDTHEPEASANTCARRIEDOFFTHEFOWLNOWHEHADREALLYDONEAG\
REATDEALOFBUSINESSONHISWAYTOTHEFAIRANDHEWASHOTANDTIREDHEWANTEDSOMETHINGTOEATAND\
AGLASSOFALETOREFRESHHIMSELFSOHETURNEDHISSTEPSTOANINNHEWASJUSTABOUTTOENTERWHENTH\
EOSTLERCAMEOUTANDTHEYMETATTHEDOORTHEOSTLERWASCARRYINGASACKWHATHAVEYOUINTHATSACK\
ASKEDTHEPEASANTROTTENAPPLESANSWEREDTHEOSTLERAWHOLESACKFULOFTHEMTHEYWILLDOTOFEED\
THEPIGSWITHWHYTHATWILLBETERRIBLEWASTEHEREPLIEDISHOULDLIKETOTAKETHEMHOMETOMYOLDW\
OMANLASTYEARTHEOLDAPPLETREEBYTHEGRASSPLOTONLYBOREONEAPPLEANDWEKEPTITINTHECUPBOA\
RDTILLITWASQUITEWITHEREDANDROTTENITWASALWAYSPROPERTYMYOLDWOMANSAIDANDHERESHEWOU\
LDSEEAGREATDEALOFPROPERTYAWHOLESACKFULISHOULDLIKETOSHOWTHEMTOHERWHATWILLYOUGIVE\
MEFORTHESACKFULASKEDTHEOSTLERWHATWILLIGIVEWELLIWILLGIVEYOUMYFOWLINEXCHANGESOHEG\
AVEUPTHEFOWLANDRECEIVEDTHEAPPLESWHICHHECARRIEDINTOTHEINNPARLORHELEANEDTHESACKCA\
REFULLYAGAINSTTHESTOVEANDTHENWENTTOTHETABLEBUTTHESTOVEWASHOTANDHEHADNOTTHOUGHTO\
FTHATMANYGUESTSWEREPRESENTHORSEDEALERSCATTLEDROVERSANDTWOENGLISHMENTHEENGLISHME\
NWERESORICHTHATTHEIRPOCKETSQUITEBULGEDOUTANDSEEMEDREADYTOBURSTANDTHEYCOULDBETTO\
OASYOUSHALLHEARHISSSSHISSSSWHATCOULDTHATBEBYTHESTOVETHEAPPLESWEREBEGINNINGTOROA\
STWHATISTHATASKEDONEWHYDOYOUKNOWSAIDOURPEASANTANDTHENHETOLDTHEMTHEWHOLESTORYOFT\
HEHORSEWHICHHEHADEXCHANGEDFORACOWANDALLTHERESTOFITDOWNTOTHEAPPLESWELLYOUROLDWOM\
ANWILLGIVEITYOUWELLWHENYOUGETHOMESAIDONEOFTHEENGLISHMENWONTTHEREBEANOISEWHATGIV\
EMEWHATSAIDTHEPEASANTWHYSHEWILLKISSMEANDSAYWHATTHEOLDMANDOESISALWAYSRIGHTLETUSL\
AYAWAGERONITSAIDTHEENGLISHMENWELLWAGERYOUATONOFCOINEDGOLDAHUNDREDPOUNDSTOTHEHUN\
DREDWEIGHTNOABUSHELWILLBEENOUGHREPLIEDTHEPEASANTICANONLYSETABUSHELOFAPPLESAGAIN\
STITANDILLTHROWMYSELFANDMYOLDWOMANINTOTHEBARGAINTHATWILLPILEUPTHEMEASUREIFANCYD\
ONETAKENANDSOTHEBETWASMADETHENTHELANDLORDSCOACHCAMETOTHEDOORANDTHETWOENGLISHMEN\
ANDTHEPEASANTGOTINANDAWAYTHEYDROVEANDSOONARRIVEDANDSTOPPEDATTHEPEASANTSHUTGOODE\
VENINGOLDWOMANGOODEVENINGOLDMANIVEMADETHEEXCHANGEAHWELLYOUUNDERSTANDWHATYOUREAB\
OUTSAIDTHEWOMANTHENSHEEMBRACEDHIMANDPAIDNOATTENTIONTOTHESTRANGERSNORDIDSHENOTIC\
ETHESACKIGOTACOWINEXCHANGEFORTHEHORSETHANKHEAVENSAIDSHENOWWESHALLHAVEPLENTYOFMI\
LKANDBUTTERANDCHEESEONTHETABLETHATWASACAPITALEXCHANGEYESBUTICHANGEDTHECOWFORASH\
EEPAHBETTERSTILLCRIEDTHEWIFEYOUALWAYSTHINKOFEVERYTHINGWEHAVEJUSTENOUGHPASTUREFO\
RASHEEPEWESMILKANDCHEESEWOOLLENJACKETSANDSTOCKINGSTHECOWCOULDNOTGIVEALLTHESEAND\
HERHAIRONLYFALLSOFFHOWYOUTHINKOFEVERYTHINGBUTICHANGEDAWAYTHESHEEPFORAGOOSETHENW\
ESHALLHAVEROASTGOOSETOEATTHISYEARYOUDEAROLDMANYOUAREALWAYSTHINKINGOFSOMETHINGTO\
PLEASEMETHISISDELIGHTFULWECANLETTHEGOOSEWALKABOUTWITHASTRINGTIEDTOHERLEGSOSHEWI\
LLBEFATTERSTILLBEFOREWEROASTHERBUTIGAVEAWAYTHEGOOSEFORAFOWLAFOWLWELLTHATWASAGOO\
DEXCHANGEREPLIEDTHEWOMANTHEFOWLWILLLAYEGGSANDHATCHTHEMANDWESHALLHAVECHICKENSWES\
HALLSOONHAVEAPOULTRYYARDOHTHISISJUSTWHATIWASWISHINGFORYESBUTIEXCHANGEDTHEFOWLFO\
RASACKOFSHRIVELLEDAPPLESWHATIREALLYMUSTGIVEYOUAKISSFORTHATEXCLAIMEDTHEWIFEMYDEA\
RGOODHUSBANDNOWILLTELLYOUSOMETHINGDOYOUKNOWALMOSTASSOONASYOULEFTMETHISMORNINGIB\
EGANTOTHINKOFWHATICOULDGIVEYOUNICEFORSUPPERTHISEVENINGANDTHENITHOUGHTOFFRIEDEGG\
SANDBACONWITHSWEETHERBSIHADEGGSANDBACONBUTIWANTEDTHEHERBSSOIWENTOVERTOTHESCHOOL\
MASTERSIKNEWTHEYHADPLENTYOFHERBSBUTTHESCHOOLMISTRESSISVERYMEANALTHOUGHSHECANSMI\
LESOSWEETLYIBEGGEDHERTOLENDMEAHANDFULOFHERBSLENDSHEEXCLAIMEDIHAVENOTHINGTOLENDN\
OTHINGATALLGROWSINOURGARDENNOTEVENASHRIVELLEDAPPLEICOULDNOTEVENLENDYOUASHRIVELL\
EDAPPLEMYDEARWOMANBUTNOWICANLENDHERTENORAWHOLESACKFULWHICHIMVERYGLADOFITMAKESME\
LAUGHTOTHINKABOUTITANDTHENSHEGAVEHIMAHEARTYKISSWELLILIKEALLTHISSAIDBOTHTHEENGLI\
SHMENALWAYSGOINGDOWNTHEHILLANDYETALWAYSMERRYITSWORTHTHEMONEYTOSEEITSOTHEYPAIDAH\
UNDREDWEIGHTOFGOLDTOTHEPEASANTWHOWHATEVERHEDIDWASNOTSCOLDEDBUTKISSEDYESITALWAYS\
PAYSBESTWHENTHEWIFESEESANDMAINTAINSTHATHERHUSBANDKNOWSBESTANDWHATEVERHEDOESISRI\
GHTTHATISASTORYWHICHIHEARDWHENIWASACHILDANDNOWYOUHAVEHEARDITTOOANDKNOWTHATWHATT\
HEOLDMANDOESISALWAYSRIGHT
> V5:=VigenereCryptosystem(10);
> k5:=V5!"IOAQSNFANY";
> Enciphering(k5,Encoding(V5,sct5));
MARLEYWASDEADTOBEGINWITHTHEREISNODOUBTWHATEVERABOUTTHATTHEREGISTEROFHISBURIALWA\
SSIGNEDBYTHECLERGYMANTHECLERKTHEUNDERTAKERANDTHECHIEFMOURNERSCROOGESIGNEDITANDS\
CROOGESNAMEWASGOODUPONCHANGEFORANYTHINGHECHOSETOPUTHISHANDTOOLDMARLEYWASASDEADA\
SADOORNAILMINDIDONTMEANTOSAYTHATIKNOWOFMYOWNKNOWLEDGEWHATTHEREISPARTICULARLYDEA\
DABOUTADOORNAILIMIGHTHAVEBEENINCLINEDMYSELFTOREGARDACOFFINNAILASTHEDEADESTPIECE\
OFIRONMONGERYINTHETRADEBUTTHEWISDOMOFOURANCESTORSISINTHESIMILEANDMYUNHALLOWEDHA\
NDSSHALLNOTDISTURBITORTHECOUNTRYSDONEFORYOUWILLTHEREFOREPERMITMETOREPEATEMPHATI\
CALLYTHATMARLEYWASASDEADASADOORNAILSCROOGEKNEWHEWASDEADOFCOURSEHEDIDHOWCOULDITB\
EOTHERWISESCROOGEANDHEWEREPARTNERSFORIDONTKNOWHOWMANYYEARSSCROOGEWASHISSOLEEXEC\
UTORHISSOLEADMINISTRATORHISSOLEASSIGNHISSOLERESIDUARYLEGATEEHISSOLEFRIENDANDSOL\
EMOURNERANDEVENSCROOGEWASNOTSODREADFULLYCUTUPBYTHESADEVENTBUTTHATHEWASANEXCELLE\
NTMANOFBUSINESSONTHEVERYDAYOFTHEFUNERALANDSOLEMNISEDITWITHANUNDOUBTEDBARGAINTHE\
MENTIONOFMARLEYSFUNERALBRINGSMEBACKTOTHEPOINTISTARTEDFROMTHEREISNODOUBTTHATMARL\
EYWASDEADTHISMUSTBEDISTINCTLYUNDERSTOODORNOTHINGWONDERFULCANCOMEOFTHESTORYIAMGO\
INGTORELATEIFWEWERENOTPERFECTLYCONVINCEDTHATHAMLETSFATHERDIEDBEFORETHEPLAYBEGAN\
THEREWOULDBENOTHINGMOREREMARKABLEINHISTAKINGASTROLLATNIGHTINANEASTERLYWINDUPONH\
ISOWNRAMPARTSTHANTHEREWOULDBEINANYOTHERMIDDLEAGEDGENTLEMANRASHLYTURNINGOUTAFTER\
DARKINABREEZYSPOTSAYSAINTPAULSCHURCHYARDFORINSTANCELITERALLYTOASTONISHHISSONSWE\
AKMINDSCROOGENEVERPAINTEDOUTOLDMARLEYSNAMETHEREITSTOODYEARSAFTERWARDSABOVETHEWA\
REHOUSEDOORSCROOGEANDMARLEYTHEFIRMWASKNOWNASSCROOGEANDMARLEYSOMETIMESPEOPLENEWT\
OTHEBUSINESSCALLEDSCROOGESCROOGEANDSOMETIMESMARLEYBUTHEANSWEREDTOBOTHNAMESITWAS\
ALLTHESAMETOHIMOHBUTHEWASATIGHTFISTEDHANDATTHEGRINDSTONESCROOGEASQUEEZINGWRENCH\
INGGRASPINGSCRAPINGCLUTCHINGCOVETOUSOLDSINNERHARDANDSHARPASFLINTFROMWHICHNOSTEE\
LHADEVERSTRUCKOUTGENEROUSFIRESECRETANDSELFCONTAINEDANDSOLITARYASANOYSTERTHECOLD\
WITHINHIMFROZEHISOLDFEATURESNIPPEDHISPOINTEDNOSESHRIVELLEDHISCHEEKSTIFFENEDHISG\
AITMADEHISEYESREDHISTHINLIPSBLUEANDSPOKEOUTSHREWDLYINHISGRATINGVOICEAFROSTYRIME\
WASONHISHEADANDONHISEYEBROWSANDHISWIRYCHINHECARRIEDHISOWNLOWTEMPERATUREALWAYSAB\
OUTWITHHIMHEICEDHISOFFICEINTHEDOGDAYSANDDIDNTTHAWITONEDEGREEATCHRISTMASEXTERNAL\
HEATANDCOLDHADLITTLEINFLUENCEONSCROOGENOWARMTHCOULDWARMNOWINTRYWEATHERCHILLHIMN\
OWINDTHATBLEWWASBITTERERTHANHENOFALLINGSNOWWASMOREINTENTUPONITSPURPOSENOPELTING\
RAINLESSOPENTOENTREATYFOULWEATHERDIDNTKNOWWHERETOHAVEHIMTHEHEAVIESTRAINANDSNOWA\
NDHAILANDSLEETCOULDBOASTOFTHEADVANTAGEOVERHIMINONLYONERESPECTTHEYOFTENCAMEDOWNH\
ANDSOMELYANDSCROOGENEVERDIDNOBODYEVERSTOPPEDHIMINTHESTREETTOSAYWITHGLADSOMELOOK\
SMYDEARSCROOGEHOWAREYOUWHENWILLYOUCOMETOSEEMENOBEGGARSIMPLOREDHIMTOBESTOWATRIFL\
ENOCHILDRENASKEDHIMWHATITWASOCLOCKNOMANORWOMANEVERONCEINALLHISLIFEINQUIREDTHEWA\
YTOSUCHANDSUCHAPLACEOFSCROOGEEVENTHEBLINDMENSDOGSAPPEAREDTOKNOWHIMANDWHENTHEYSA\
WHIMCOMINGONWOULDTUGTHEIROWNERSINTODOORWAYSANDUPCOURTSANDTHENWOULDWAGTHEIRTAILS\
ASTHOUGHTHEYSAIDNOEYEATALLISBETTERTHANANEVILEYEDARKMASTERBUTWHATDIDSCROOGECAREI\
TWASTHEVERYTHINGHELIKEDTOEDGEHISWAYALONGTHECROWDEDPATHSOFLIFEWARNINGALLHUMANSYM\
PATHYTOKEEPITSDISTANCEWASWHATTHEKNOWINGONESCALLNUTSTOSCROOGEONCEUPONATIMEOFALLT\
HEGOODDAYSINTHEYEARONCHRISTMASEVEOLDSCROOGESATBUSYINHISCOUNTINGHOUSEITWASCOLDBL\
EAKBITINGWEATHERFOGGYWITHALANDHECOULDHEARTHEPEOPLEINTHECOURTOUTSIDEGOWHEEZINGUP\
ANDDOWNBEATINGTHEIRHANDSUPONTHEIRBREASTSANDSTAMPINGTHEIRFEETUPONTHEPAVEMENTSTON\
ESTOWARMTHEMTHECITYCLOCKSHADONLYJUSTGONETHREEBUTITWASQUITEDARKALREADYITHADNOTBE\
ENLIGHTALLDAYANDCANDLESWEREFLARINGINTHEWINDOWSOFTHENEIGHBOURINGOFFICESLIKERUDDY\
SMEARSUPONTHEPALPABLEBROWNAIRTHEFOGCAMEPOURINGINATEVERYCHINKANDKEYHOLEANDWASSOD\
ENSEWITHOUTTHATALTHOUGHTHECOURTWASOFTHENARROWESTTHEHOUSESOPPOSITEWEREMEREPHANTO\
MSTOSEETHEDINGYCLOUDCOMEDROOPINGDOWNOBSCURINGEVERYTHINGONEMIGHTHAVETHOUGHTTHATN\
ATURELIVEDHARDBYANDWASBREWINGONALARGESCALETHEDOOROFSCROOGESCOUNTINGHOUSEWASOPEN\
THATHEMIGHTKEEPHISEYEUPONHISCLERKWHOINADISMALLITTLECELLBEYONDASORTOFTANKWASCOPY\
INGLETTERSSCROOGEHADAVERYSMALLFIREBUTTHECLERKSFIREWASSOVERYMUCHSMALLERTHATITLOO\
KEDLIKEONECOALBUTHECOULDNTREPLENISHITFORSCROOGEKEPTTHECOALBOXINHISOWNROOMANDSOS\
URELYASTHECLERKCAMEINWITHTHESHOVELTHEMASTERPREDICTEDTHATITWOULDBENECESSARYFORTH\
EMTOPARTWHEREFORETHECLERKPUTONHISWHITECOMFORTERANDTRIEDTOWARMHIMSELFATTHECANDLE\
INWHICHEFFORTNOTBEINGAMANOFASTRONGIMAGINATIONHEFAILEDAMERRYCHRISTMASUNCLEGODSAV\
EYOUCRIEDACHEERFULVOICEITWASTHEVOICEOFSCROOGESNEPHEWWHOCAMEUPONHIMSOQUICKLYTHAT\
THISWASTHEFIRSTINTIMATIONHEHADOFHISAPPROACHBAHSAIDSCROOGEHUMBUG
> /*
> Since transposition ciphers do not change the relative frequencies of the
> letters but simply reorder the letters within each message, the relative
> frequencies in a transposition enciphered message will exactly the same as
> they were in the plaintext, and hence typical of what you get from unenciphered
> English text. Substitution ciphers, however, cause many letters to have frequencies
> that are quite different from their frequencies in typical English. The same set of
> frequencies are assigned to the same set of letters, but in a different order.
> */
> SortedFreqDist(sct1);
[ <0.132410107180476188659667968750, I>, <0.0947521869093179702758789062500, O>,
<0.0889212824404239654541015625000, X>, <0.0792031101882457733154296875000, Z>,
<0.0711856167763471603393554687500, P>, <0.0685131195932626724243164062500, L>,
<0.0658406224101781845092773437500, V>, <0.0568513120524585247039794921875, B>,
<0.0532069969922304153442382812500, C>, <0.0522351795807480812072753906250, U>,
<0.0500485906377434730529785156250, G>, <0.0291545188520103693008422851562, M>,
<0.0242954324930906295776367187500, N>, <0.0225947522558271884918212890625, E>,
<0.0196793002542108297348022460938, F>, <0.0194363459013402462005615234375, Y>,
<0.0189504374284297227859497070312, R>, <0.0140913508366793394088745117188, H>,
<0.0121477162465453147888183593750, T>, <0.0114188533043488860130310058594, Q>,
<0.00680272106546908617019653320312, S>, <0.00631681241793558001518249511719, A>,
<0.000971817295067012310028076171875, J>, <0.000728862971300259232521057128906, K>,
<0.000242954323766753077507019042969, W>, <0.000000000000000000000000000000, D> ]
> /*
> This is certainly not the same as typical English. X and Z would never be
> the third and fourth most frequent letters in a piece of text. So a
> substitution cipher must have been used for ct1.
> */
> SortedFreqDist(sct4);
[ <0.127444546669721603393554687500, U>, <0.101719385944306850433349609375, J>,
<0.0756004722788929939270019531250, X>, <0.0752067202702164649963378906250, T>,
<0.0651004072278738021850585937500, O>, <0.0641816509887576103210449218750, Z>,
<0.0602441267110407352447509765625, F>, <0.0601128758862614631652832031250, L>,
<0.0509253181517124176025390625000, E>, <0.0467252922244369983673095703125, D>,
<0.0406877542845904827117919921875, A>, <0.0360939754173159599304199218750, Y>,
<0.0278251739218831062316894531250, S>, <0.0261189131997525691986083984375, N>,
<0.0232313952874392271041870117188, H>, <0.0217876362148672342300415039062, G>,
<0.0216563853900879621505737304688, Q>, <0.0175876098219305276870727539062, W>,
<0.0170626067556440830230712890625, P>, <0.0160126001574099063873291015625, R>,
<0.0126000787131488323211669921875, K>, <0.00813755090348422527313232421875, I>,
<0.00236251475871540606021881103516, V>, <0.000787504919571802020072937011719, B>,
<0.000656254102068487554788589477539, M>, <0.000131250821141293272376060485840, C> ]
> /*
> Substitution cipher.
> */
> SortedFreqDist(sct6);
[ <0.128529144451022148132324218750, E>, <0.0935792345553636550903320312500, T>,
<0.0775273228064179420471191406250, A>, <0.0757058290764689445495605468750, I>,
<0.0737704914063215255737304687500, O>, <0.0677367942407727241516113281250, N>,
<0.0566939888522028923034667968750, S>, <0.0555555555038154125213623046875, H>,
<0.0549863385967910289764404296875, R>, <0.0397313297726213932037353515625, D>,
<0.0374544626101851463317871093750, L>, <0.0350637524388730525970458984375, M>,
<0.0311930782627314329147338867188, C>, <0.0306238615885376930236816406250, F>,
<0.0274362477939575910568237304688, U>, <0.0215163934044539928436279296875, Y>,
<0.0214025501627475023269653320312, W>, <0.0211748634465038776397705078125, P>,
<0.0171903460286557674407958984375, G>, <0.0144581056665629148483276367188, B>,
<0.00979052821639925241470336914062, V>, <0.00421220401767641305923461914062, K>,
<0.00216302368789911270141601562500, X>, <0.00125227686658035963773727416992, J>,
<0.000910746814042795449495315551758, Q>, <0.000341530056175542995333671569824, Z> ]
> /*
> Just like normal English. A transposition cipher was used.
> */
> SortedFreqDist(sct7);
[ <0.110627178102731704711914062500, E>, <0.0927700344473123550415039062500, A>,
<0.0831881528720259666442871093750, T>, <0.0814459929242730140686035156250, N>,
<0.0788327530026435852050781250000, H>, <0.0714285718277096748352050781250, O>,
<0.0653310101479291915893554687500, I>, <0.0627177702262997627258300781250, D>,
<0.0522648082114756107330322265625, S>, <0.0500871078111231327056884765625, L>,
<0.0391986062750220298767089843750, R>, <0.0339721255004405975341796875000, M>,
<0.0331010455265641212463378906250, W>, <0.0248257839120924472808837890625, C>,
<0.0213414633180946111679077148438, G>, <0.0204703833442181348800659179688, U>,
<0.0187282229308038949966430664062, Y>, <0.0139372822595760226249694824219, P>,
<0.0130662020528689026832580566406, F>, <0.0121951219625771045684814453125, K>,
<0.00958188157528638839721679687500, B>, <0.00479094078764319419860839843750, J>,
<0.00391986063914373517036437988281, V>, <0.00217770034214481711387634277344, X>,
<0.000000000000000000000000000000, Q>, <0.000000000000000000000000000000, Z> ]
> /*
> Another transposition cipher.
> */
> d:=[pt6[i]*pt6[i+1]: i in [1..#pt6-1]];
> d[1..7];
[ FO, OR, RT, TH, HE, EM, MO ]
> pt6[1..8];
FORTHEMO
> CoincidenceIndex(d);
0.00706865940193723755646563970225
> d:=[pt6[i]*pt6[i+2]: i in [1..#pt6-2]];
> CoincidenceIndex(d);
0.00492849992288115286698359180142
> d:=[pt6[i]*pt6[i+3]: i in [1..#pt6-3]];
> CoincidenceIndex(d);
0.00453643051535737104781264373094
> d:=[pt6[i]*pt6[i+4]: i in [1..#pt6-4]];
> CoincidenceIndex(d);
0.00424101727538355793658557216551
> /*
> The sequence of digraphs has a much higher coincidence index than the
> sequences consisting of pairs of non-adjacent letters. Even in the
> non-adjacent case the CI is greater than (1/26)^2 -- this is because some
> letters are more common than others, and the letter pairs involving
> common letters will obviously be more common than those that don't.
> But when you look at the digraphs (i.e. adjacent letters) the CI is
> much higher. This is because the frequency distribution is much less even
> in this case. Some pairs of letters have very strong tendency to occur
> together as digraphs, and others have a very strong tendency not to.
> When there are many pairs with high frequencies the CI is high.
> */
> CoincidenceIndex(Decimation(sct6,[1,8],9));
0.00471836906263135771332492643968
> CoincidenceIndex(Decimation(sct6,[8,1],9));
0.00471836906263135771332492643968
> Decimation(sct6,[8,1],9)[1..20];
[ SR, MI, YT, ER, AI, NU, EE, SE, LI, DF, ID, CT, ST, VH, SY, EJ, DO, AC, NM, EE ]
> Decimation(sct6,[1,8],9)[1..20];
[ RS, IM, TY, RE, IA, UN, EE, ES, IL, FD, DI, TC, TS, HV, YS, JE, OD, CA, MN, EE ]
> /*
> Reversing the order of each pair does not change the probability that the
> i-th pair in the sequence equals the j-th pair. If they are equal before
> reversing they are still equal after reversing. So the probability that two
> randomly chosen pairs are equal will be the same before reversing as after
> reversing. They are equal after reversing if and only if they were equal before.
> */
> for i:=2 to 9 do
for> "i =",i,": CI=",CoincidenceIndex(Decimation(sct6,[1,i],9));
for> end for;
i = 2 : CI= 0.00441361916771752837326607818411
i = 3 : CI= 0.00457755359394703656998738965952
i = 4 : CI= 0.00496847414880201765447667087011
i = 5 : CI= 0.00805380411937788986969314838168
i = 6 : CI= 0.00434846574190836485918453131568
i = 7 : CI= 0.00733711643547709121479613282892
i = 8 : CI= 0.00471836906263135771332492643968
i = 9 : CI= 0.00490752416981925178646490121900
> /*
> There are two cases where the value is noticeably higher than usual,
> namely i=5 and i=7 give high values. This means that maybe the block
> length is 9 and the 1st letter in each block was adjacent to the 5th
> letter in the block before the block was reordered, and also maybe the
> first letter was adjacent to the 7th letter before the reordering.
> The original order might have been ..517.. or ..715.. .
> */
> for j:=1 to 8 do
for> for i:=j+1 to 9 do
for|for> j,i,": CI=",CoincidenceIndex(Decimation(sct6,[j,i],9));
for|for> end for;
for> end for;
1 2 : CI= 0.00441361916771752837326607818411
1 3 : CI= 0.00457755359394703656998738965952
1 4 : CI= 0.00496847414880201765447667087011
1 5 : CI= 0.00805380411937788986969314838168
1 6 : CI= 0.00434846574190836485918453131568
1 7 : CI= 0.00733711643547709121479613282892
1 8 : CI= 0.00471836906263135771332492643968
1 9 : CI= 0.00490752416981925178646490121900
2 3 : CI= 0.00458806221101303068516183270282
2 4 : CI= 0.00414459857082807902480033627574
2 5 : CI= 0.00405212274064733081126523749474
2 6 : CI= 0.00652585119798234552332912988651
2 7 : CI= 0.00424337957124842370744010088272
2 8 : CI= 0.00778898696931483816729718369063
2 9 : CI= 0.00434636401849516603614964270702
3 4 : CI= 0.00420975199663724253888188314418
3 5 : CI= 0.00493484657419083648591845313157
3 6 : CI= 0.00680958385876418663303909205548
3 7 : CI= 0.00429171920975199663724253888188
3 8 : CI= 0.00492013451029844472467423287096
3 9 : CI= 0.00701555275325767129045817570408
4 5 : CI= 0.00427490542244640605296343001261
4 6 : CI= 0.00418873476250525430853299705759
4 7 : CI= 0.00674232870954182429592265657839
4 8 : CI= 0.00428331231609920134510298444725
4 9 : CI= 0.00402900378310214375788146279950
5 6 : CI= 0.00457124842370744010088272383354
5 7 : CI= 0.00479823455233291298865069356873
5 8 : CI= 0.00423917612442202606137032366541
5 9 : CI= 0.00643757881462799495586380832282
6 7 : CI= 0.00459016393442622950819672131147
6 8 : CI= 0.00532576712904581757040773434216
6 9 : CI= 0.00488650693568726355611601513241
7 8 : CI= 0.00463219840269020596889449348466
7 9 : CI= 0.00447667087011349306431273644388
8 9 : CI= 0.00420134510298444724674232870954
> /*
> The possible adjacencies seem to be (1,5), (1,7), (2,6) (?), (2,8), (3,6), (3,9),
> (4,7), (5,9). This gives a possible original order of 471593628 or its reverse.
> */
> T:=TranspositionCryptosystem(9);
> key:=T![4,7,1,5,9,3,6,2,8];
> Enciphering(key,Encoding(T,sct6));
FORTHEMOSTWILDYETMOSTHOMELYNARRATIVEWHICHIAMABOUTTOPENINEITHEREXPECTNORSOLICITBELIEFMADIN\
DEEDWOULDIBETOEXPECTITINACASEWHEREMYVERYSENSESREJECTTHEIROWNEVIDENCEYETMADAMINOTANDVERYSU\
RELYDOINOTDREAMBUTTOMORROWIDIEANDTODAYIWOULDUNBURTHENMYSOULMYIMMEDIATEPURPOSEISTOPLACEBEF\
ORETHEWORLDPLAINLYSUCCINCTLYANDWITHOUTCOMMENTASERIESOFMEREHOUSEHOLDEVENTSINTHEIRCONSEQUEN\
CESTHESEEVENTSHAVETERRIFIEDHAVETORTUREDHAVEDESTROYEDMEYETIWILLNOTATTEMPTTOEXPOUNDTHEMTOME\
THEYHAVEPRESENTEDLITTLEBUTHORRORTOMANYTHEYWILLSEEMLESSTERRIBLETHANBAROQUESHEREAFTERPERHAP\
SSOMEINTELLECTMAYBEFOUNDWHICHWILLREDUCEMYPHANTASMTOTHECOMMONPLACESOMEINTELLECTMORECALMMOR\
ELOGICALANDFARLESSEXCITABLETHANMYOWNWHICHWILLPERCEIVEINTHECIRCUMSTANCESIDETAILWITHAWENOTH\
INGMORETHANANORDINARYSUCCESSIONOFVERYNATURALCAUSESANDEFFECTSFROMMYINFANCYIWASNOTEDFORTHED\
OCILITYANDHUMANITYOFMYDISPOSITIONMYTENDERNESSOFHEARTWASEVENSOCONSPICUOUSASTOMAKEMETHEJEST\
OFMYCOMPANIONSIWASESPECIALLYFONDOFANIMALSANDWASINDULGEDBYMYPARENTSWITHAGREATVARIETYOFPETS\
WITHTHESEISPENTMOSTOFMYTIMEANDNEVERWASSOHAPPYASWHENFEEDINGANDCARESSINGTHEMTHISPECULIAROFC\
HARACTERGREWWITHMYGROWTHANDINMYMANHOODIDERIVEDFROMITONEOFMYPRINCIPALSOURCESOFPLEASURETOTH\
OSEWHOHAVECHERISHEDANAFFECTIONFORAFAITHFULANDSAGACIOUSDOGINEEDHARDLYBEATTHETROUBLEOFEXPLA\
ININGTHENATUREORTHEINTENSITYOFTHEGRATIFICATIONTHUSDERIVABLETHEREISSOMETHINGINTHEUNSELFISH\
ANDSELFSACRIFICINGLOVEOFABRUTEWHICHGOESDIRECTLYTOTHEHEARTOFHIMWHOHASHADFREQUENTOCCASIONTO\
TESTTHEPALTRYFRIENDSHIPANDGOSSAMERFIDELITYOFMEREMANIMARRIEDEARLYANDWASHAPPYTOFINDINMYWIFE\
ADISPOSITIONNOTUNCONGENIALWITHMYOWNOBSERVINGMYPARTIALITYFORDOMESTICPETSSHELOSTNOOPPORTUNI\
TYOFPROCURINGTHOSEOFTHEMOSTAGREEABLEKINDWEHADBIRDSGOLDFISHAFINEDOGRABBITSASMALLMONKEYANDA\
CATTHISLATTERWASAREMARKABLYLARGEANDBEAUTIFULANIMALENTIRELYBLACKANDSAGACIOUSTOANASTONISHIN\
GDEGREEINSPEAKINGOFHISINTELLIGENCEMYWIFEWHOATHEARTWASNOTALITTLETINCTUREDWITHSUPERSTITIONM\
ADEFREQUENTALLUSIONTOTHEANCIENTPOPULARNOTIONWHICHREGARDEDALLBLACKCATSASWITCHESINDISGUISEN\
OTTHATSHEWASEVERSERIOUSUPONTHISPOINTANDIMENTIONTHEMATTERATALLFORNOBETTERREASONTHANTHATITH\
APPENSJUSTNOWTOBEREMEMBEREDPLUTOTHISWASTHECATSNAMEWASMYFAVORITEPETANDPLAYMATEIALONEFEDHIM\
ANDHEATTENDEDMEWHEREVERIWENTABOUTTHEHOUSEITWASEVENWITHDIFFICULTYTHATICOULDPREVENTHIMFROMF\
OLLOWINGMETHROUGHTHESTREETSOURFRIENDSHIPLASTEDINTHISMANNERFORSEVERALYEARSDURINGWHICHMYGEN\
ERALTEMPERAMENTANDCHARACTERTHROUGHTHEINSTRUMENTALITYOFTHEFIENDINTEMPERANCEHADIBLUSHTOCONF\
ESSITEXPERIENCEDARADICALALTERATIONFORTHEWORSEIGREWDAYBYDAYMOREMOODYMOREIRRITABLEMOREREGAR\
DLESSOFTHEFEELINGSOFOTHERSISUFFEREDMYSELFTOUSEINTEMPERATELANGUAGETOMYATLENGTHIEVENOFFERED\
HERPERSONALVIOLENCEMYPETSOFCOURSEWEREMADETOFEELTHECHANGEINMYDISPOSITIONINOTONLYNEGLECTEDB\
UTILLUSEDTHEMFORPLUTOHOWEVERISTILLRETAINEDSUFFICIENTREGARDTORESTRAINMEFROMMALTREATINGHIMA\
SIMADENOSCRUPLEOFMALTREATINGTHERABBITSTHEMONKEYOREVENTHEDOGWHENBYACCIDENTORTHROUGHAFFECTI\
ONTHEYCAMEINMYWAYBUTMYDISEASEGREWUPONMEFORWHATDISEASEISLIKEALCOHOLANDATLENGTHEVENPLUTOWHO\
WASNOWBECOMINGOLDANDCONSEQUENTLYSOMEWHATPEEVISHEVENPLUTOBEGANTOEXPERIENCETHEEFFECTSOFMYIL\
LTEMPERONENIGHTRETURNINGHOMEMUCHINTOXICATEDFROMONEOFMYHAUNTSABOUTTOWNIFANCIEDTHATTHECATAV\
OIDEDMYPRESENCEISEIZEDHIMWHENINHISFRIGHTATMYVIOLENCEHEINFLICTEDASLIGHTWOUNDUPONMYHANDWITH\
HISTEETHTHEFURYOFADEMONINSTANTLYPOSSESSEDMEIKNEWMYSELFNOLONGERMYORIGINALSOULSEEMEDATONCET\
OTAKEITSFLIGHTFROMMYBODYANDAMORETHANFIENDISHMALEVOLENCEGINNURTUREDTHRILLEDEVERYFIBREOFMYF\
RAMEITOOKFROMMYWAISTCOATPOCKETAPENKNIFEOPENEDITGRASPEDTHEPOORBEASTBYTHETHROATANDDELIBERAT\
ELYCUTONEOFITSEYESFROMTHESOCKETIBLUSHIBURNISHUDDERWHILEIPENTHEDAMNABLEATROCITYWHENREASONR\
ETURNEDWITHTHEMORNINGWHENIHADSLEPTOFFTHEFUMESOFTHENIGHTSDEBAUCHIEXPERIENCEDASENTIMENTHALF\
OFHORRORHALFOFREMORSEFORTHECRIMEOFWHICHIHADBEENGUILTYBUTITWASATBESTAFEEBLEANDEQUIVOCALFEE\
LINGANDTHESOULREMAINEDUNTOUCHEDIAGAINPLUNGEDINTOEXCESSANDSOONDROWNEDINWINEALLMEMORYOFTHED\
EEDINTHEMEANTIMETHECATSLOWLYRECOVEREDTHESOCKETOFTHELOSTEYEPRESENTEDITISTRUEAFRIGHTFULAPPE\
ARANCEBUTHENOLONGERAPPEAREDTOSUFFERANYPAINHEWENTABOUTTHEHOUSEASUSUALBUTASMIGHTBEEXPECTEDF\
LEDINEXTREMETERRORATMYAPPROACHIHADSOMUCHOFMYOLDHEARTLEFTASTOBEATFIRSTGRIEVEDBYTHISEVIDENT\
DISLIKEONTHEPARTOFACREATUREWHICHHADONCESOLOVEDMEBUTTHISFEELINGSOONGAVEPLACETOIRRITATIONAN\
DTHENCAMEASIFTOMYFINALANDIRREVOCABLEOVERTHROWTHESPIRITOFPERVERSENESSOFTHISSPIRITPHILOSOPH\
YTAKESNOACCOUNTYETIAMNOTMORESURETHATMYSOULLIVESTHANIAMTHATPERVERSENESSISONEOFTHEPRIMITIVE\
IMPULSESOFTHEHUMANHEARTONEOFTHEINDIVISIBLEPRIMARYFACULTIESORSENTIMENTSWHICHGIVEDIRECTIONT\
OTHECHARACTEROFMANWHOHASNOTAHUNDREDTIMESFOUNDHIMSELFCOMMITTINGAVILEORASILLYACTIONFORNOOTH\
ERREASONTHANBECAUSEHEKNOWSHESHOULDNOTHAVEWENOTAPERPETUALINCLINATIONINTHETEETHOFOURBESTJUD\
GMENTTOVIOLATETHATWHICHISLAWMERELYBECAUSEWEUNDERSTANDITTOBESUCHTHISSPIRITOFPERVERSENESSIS\
AYCAMETOMYFINALOVERTHROWITWASTHISUNFATHOMABLELONGINGOFTHESOULTOVEXITSELFTOOFFERVIOLENCETO\
ITSOWNNATURETODOWRONGFORTHEWRONGSSAKEONLYTHATURGEDMETOCONTINUEANDFINALLYTOCONSUMMATETHEIN\
JURYIHADINFLICTEDUPONTHEUNOFFENDINGBRUTEONEMORNINGINCOOLBLOODISLIPPEDANOOSEABOUTITSNECKAN\
DHUNGITTOTHELIMBOFATREEHUNGITWITHTHETEARSSTREAMINGFROMMYEYESANDWITHTHEBITTERESTREMORSEATM\
YHEARTHUNGITBECAUSEIKNEWTHATITHADLOVEDMEANDBECAUSEIFELTITHADGIVENMENOREASONOFOFFENCEHUNGI\
TBECAUSEIKNEWTHATINSODOINGIWASCOMMITTINGASINADEADLYSINTHATWOULDSOJEOPARDIZEMYIMMORTALSOUL\
ASTOPLACEITIFSUCHATHINGWEREPOSSIBLEEVENBEYONDTHEREACHOFTHEINFINITEMERCYOFTHEMOSTMERCIFULA\
NDMOSTTERRIBLEGODONTHENIGHTOFTHEDAYONWHICHTHISCRUELDEEDWASDONEIWASAROUSEDFROMSLEEPBYTHECR\
YOFFIRETHECURTAINSOFMYBEDWEREINFLAMESTHEWHOLEHOUSEWASBLAZINGITWASWITHGREATDIFFICULTYTHATM\
YWIFEASERVANTANDMYSELFMADEOURESCAPEFROMTHECONFLAGRATIONTHEDESTRUCTIONWASCOMPLETEMYENTIREW\
ORLDLYWEALTHWASSWALLOWEDUPANDIRESIGNEDMYSELFTHENCEFORWARDTODESPAIRIAMABOVETHEWEAKNESSOFSE\
EKINGTOESTABLISHASEQUENCEOFCAUSEANDEFFECTBETWEENTHEDISASTERANDTHEATROCITYBUTIAMDETAILINGA\
CHAINOFFACTSANDWISHNOTTOLEAVEEVENAPOSSIBLELINKIMPERFECTONTHEDAYSUCCEEDINGTHEFIREIVISITEDT\
HERUINSTHEWALLSWITHONEEXCEPTIONHADFALLENINTHISEXCEPTIONWASFOUNDINACOMPARTMENTWALLNOTVERYT\
HICKWHICHSTOODABOUTTHEMIDDLEOFTHEHOUSEANDAGAINSTWHICHHADRESTEDTHEHEADOFMYBEDTHEPLASTERING\
HADHEREINGREATMEASURERESISTEDTHEACTIONOFTHEFIREAFACTWHICHIATTRIBUTEDTOITSHAVINGBEENRECENT\
LYSPREADABOUTTHISWALLADENSECROWDWERECOLLECTEDANDMANYPERSONSSEEMEDTOBEEXAMININGAPARTICULAR\
PORTIONOFITWITHEVERYMINUTEANDEAGERATTENTIONTHEWORDSSTRANGESINGULARANDOTHERSIMILAREXPRESSI\
ONSEXCITEDMYCURIOSITYIAPPROACHEDANDSAWASIFGRAVENINBASRELIEFUPONTHEWHITESURFACETHEFIGUREOF\
AGIGANTICCATTHEIMPRESSIONWASGIVENWITHANACCURACYTRULYMARVELLOUSTHEREWASAROPEABOUTTHEANIMAL\
SNECKWHENIFIRSTBEHELDTHISAPPARITIONFORICOULDSCARCELYREGARDITASLESSMYWONDERANDMYTERRORWERE\
EXTREMEBUTATLENGTHREFLECTIONCAMETOMYAIDTHECATIREMEMBEREDHADBEENHUNGINAGARDENADJACENTTOTHE\
HOUSEUPONTHEALARMOFFIRETHISGARDENHADBEENIMMEDIATELYFILLEDBYTHECROWDBYSOMEONEOFWHOMTHEANIM\
ALMUSTHAVEBEENCUTFROMTHETREEANDTHROWNTHROUGHANOPENWINDOWINTOMYCHAMBERTHISHADPROBABLYBEEND\
ONEWITHTHEVIEWOFAROUSINGMEFROMSLEEPTHEFALLINGOFOTHERWALLSHADCOMPRESSEDTHEVICTIMOFMYCRUELT\
YINTOTHESUBSTANCEOFTHEFRESHLYSPREADPLASTERTHELIMEOFWHICHHADTHENWITHTHEFLAMESANDTHEAMMONIA\
FROMTHECARCASSACCOMPLISHEDTHEPORTRAITUREASISAWITALTHOUGHITHUSREADILYACCOUNTEDTOMYREASONIF\
NOTALTOGETHERTOMYCONSCIENCEFORTHESTARTLINGFACTJUSTDETAILEDITDIDNOTTHELESSFALLTOMAKEADEEPI\
MPRESSIONUPONMYFANCYFORMONTHSICOULDNOTRIDMYSELFOFTHEPHANTASMOFTHECATANDDURINGTHISPERIODTH\
ERECAMEBACKINTOMYSPIRITAHALFSENTIMENTTHATSEEMEDBUTWASNOTREMORSEIWENTSOFARASTOREGRETTHELOS\
SOFTHEANIMALANDTOLOOKABOUTMEAMONGTHEVILEHAUNTSWHICHINOWHABITUALLYFREQUENTEDFORANOTHERPETO\
FTHESAMESPECIESANDOFSOMEWHATSIMILARAPPEARANCEWITHWHICHTOSUPPLYITSPLACEONENIGHTASISATHALFS\
TUPEFIEDINADENOFMORETHANINFAMYMYATTENTIONWASSUDDENLYDRAWNTOSOMEBLACKOBJECTREPOSINGUPONTHE\
HEADOFONEOFTHEIMMENSEHOGSHEADSOFGINOROFRUMWHICHCONSTITUTEDTHECHIEFFURNITUREOFTHEAPARTMENT\
IHADBEENLOOKINGSTEADILYATTHETOPOFTHISHOGSHEADFORSOMEMINUTESANDWHATNOWCAUSEDMESURPRISEWAST\
HEFACTTHATIHADNOTSOONERPERCEIVEDTHEOBJECTTHEREUPONIAPPROACHEDITANDTOUCHEDITWITHMYHANDITWA\
SABLACKCATAVERYLARGEONEFULLYASLARGEASPLUTOANDCLOSELYRESEMBLINGHIMINEVERYRESPECTBUTONEPLUT\
OHADNOTAWHITEHAIRUPONANYPORTIONOFHISBODYBUTTHISCATHADALARGEALTHOUGHINDEFINITESPLOTCHOFWHI\
TECOVERINGNEARLYTHEWHOLEREGIONOFTHEBREASTUPONMYTOUCHINGHIMHEIMMEDIATELYAROSEPURREDLOUDLYR\
UBBEDAGAINSTMYHANDANDAPPEAREDDELIGHTEDWITHMYNOTICETHISTHENWASTHEVERYCREATUREOFWHICHIWASIN\
SEARCHIATONCEOFFEREDTOPURCHASEITOFTHELANDLORDBUTTHISPERSONMADENOCLAIMTOITKNEWNOTHINGOFITH\
ADNEVERSEENITBEFOREICONTINUEDMYCARESSESANDWHENIPREPAREDTOGOHOMETHEANIMALEVINCEDADISPOSITI\
ONTOACCOMPANYMEIPERMITTEDITTODOSOOCCASIONALLYSTOOPINGANDPATTINGITASIPROCEEDEDWHENITREACHE\
DTHEHOUSEITDOMESTICATEDITSELFATONCEANDBECAMEIMMEDIATELYAGREATFAVORITEWITHMYWIFEFORMYOWNPA\
RTISOONFOUNDADISLIKETOITARISINGWITHINMETHISWASJUSTTHEREVERSEOFWHATIHADANTICIPATEDBUTIKNOW\
NOTHOWORWHYITWASITSEVIDENTFONDNESSFORMYSELFRATHERDISGUSTEDANDA
> /*
> "For the most wild yet most homely narrative ...". This is from the story
> "The Black Cat" by Edgar Allen Poe.
> It looks like the lowest the CI gets for sequences of digraphs from
> English text is about 0.0064. The figure 0.01 that I gave on the question sheet
> appears to be a bit higher than it should have been.
>
> Let's try ct7 by the same method.
> The first step is to try to find the block length by finding an i and an m
> such that Decimation(sct7,[1,i],m) has a high CI.
> */
> for m:=2 to 20 do
for> for i:=2 to m do
for|for> CoincidenceIndex(Decimation(sct7,[1,i],m));
for|for> end for;
for> end for;
0.00535102934788221963674363359650
0.00554015672586661191527221708928
0.00426034288060774047839030900318
0.00532073383561060741497467330694
0.00432347629385044785376799168141
0.00489507512876175882177669944239
0.00582241630276564774381368267831
0.00440486723558904396304858673212
0.00453805976539087250620772326398
0.00412896842385668483793323248756
0.00535927773426227480727212763326
0.00410877959626774401890863118550
0.00457599868079317310467081667148
0.00425993871184950048783169119567
0.00395762048068598754998557117533
0.00939807563213246811367196240770
0.00934213470575072723204296263146
0.00749608413515327813828597001566
0.00453121503692101141194898187514
0.00488550757067203699559931379130
0.00585515029462221227716864324607
0.00579907896981067712775029848200
0.00438585804439462976048341902000
0.00494627323895616578543407811701
0.00382544284983309373553275992300
0.00480007797080967812675129748300
0.00428839453229697132136156526400
0.00460515094661436124850758997101
0.00626833410529566157171530029335
0.00441562451752354485101127065000
0.00463177396943029180176007410838
0.00450825999691215068704647213216
0.00361278369615562760537285780454
0.00463177396943029180176007410838
0.00444650301065308012968967114405
0.00426123205187586845761926817971
0.00601394315483030720907071171378
0.00402206389335784877039760974488
0.00490308741285528231057994330805
0.00352409407798973416072933425266
0.00482647667202941852447713169386
0.00452003370872596338006588523711
0.00425189611583544012870604458745
0.00402206389335784877039760974488
0.00363901018922852983988355167395
0.00594574507617985878855444072835
0.00459866220735785953177257525083
0.00431995540691192865105908584169
0.00455221107395020438498699368265
0.00483091787439613526570048309178
0.00478446674098848011891490152360
0.00422705314009661835748792270532
0.00380899293942772203641768859160
0.00348383500557413600891861761427
0.00510962467484206614641397250093
0.00507026729126481124276660236980
0.00473959768531275833562965004133
0.00484982088729677597134196748415
0.00507026729126481124276660236980
0.00512537889225682006062276109121
0.00429870487737668779278038027005
0.00545604849820887296775971341968
0.00363736566547258197850647561312
0.00589694130614494351060898319096
0.00440892807936070542849269771287
0.00540093689721686414990355469826
0.00512987012987012987012987012987
0.00370129870129870129870129870130
0.00584415584415584415584415584416
0.00441558441558441558441558441558
0.00441558441558441558441558441558
0.00474025974025974025974025974026
0.00590909090909090909090909090909
0.00363636363636363636363636363636
0.00441558441558441558441558441558
0.00383116883116883116883116883117
0.00396103896103896103896103896104
0.00487012987012987012987012987013
0.0108484213676492593146790363609
0.00830465359868322609606464162801
0.00950172078407900643423612150231
0.00546161903336824779290737692653
0.00471345204249588508155020200509
0.00546161903336824779290737692653
0.00418973514888523118360017956008
0.00448900194523417626814304952866
0.00389046835253628609905730959150
0.00441418524614693999700733203651
0.00404010175071075864132874457579
0.00553643573245548406404309441868
0.00463863534340864881041448451294
0.00593395252837977296181630546955
0.00343997248022015823873409012728
0.00498796009631922944616443068456
0.00352597179222566219470244238046
0.00412796697626418988648090815273
0.00472996216030271757825937392501
0.00455796353629170966632266941865
0.00464396284829721362229102167182
0.00395596835225318197454420364637
0.00464396284829721362229102167182
0.00524595803233574131406948744410
0.00472996216030271757825937392501
0.00421396628826969384244926040592
0.00447196422428620571035431716546
0.00689451393676745789421845759874
0.00364424308086279917265832758791
0.00443218753077908007485472274205
0.00344725696838372894710922879937
0.00492465281197675563872746971339
0.00453068058701861518762927213631
0.00443218753077908007485472274205
0.00502314586821629075150201910765
0.00393972224958140451098197577071
0.00413670836206047473653107455924
0.00472766669949768541317837092485
0.00443218753077908007485472274205
0.00374273613710233428543287698217
0.00610656948685117699202206244460
0.00551561114941396631537476607899
0.00619126589275843007186290768381
0.00287451630735212824765063571034
0.00386954118297401879491431730238
0.00508568269762299613045881702598
0.00409065782200110558319513543394
0.00420121614151464897733554449973
0.00530679933665008291873963515754
0.00420121614151464897733554449973
0.00552791597567716970702045328911
0.00386954118297401879491431730238
0.00276395798783858485351022664456
0.00552791597567716970702045328911
0.00353786622443338861249309010503
0.00420121614151464897733554449973
0.00508568269762299613045881702598
0.00353786622443338861249309010503
0.00549931258592675915510561179853
0.00424946881639795025621797275341
0.00562429696287964004499437570304
0.00449943757030371203599550056243
0.00324959380077490313710786151731
0.00449943757030371203599550056243
0.00462442194725659292588426446694
0.00287464066991626046744156980377
0.00449943757030371203599550056243
0.00387451568553930758655168103987
0.00437445319335083114610673665792
0.00412448443944506936632920884890
0.00437445319335083114610673665792
0.00312460942382202224721909761280
0.00424946881639795025621797275341
0.00587426571678540182477190351206
0.00437445319335083114610673665792
0.00378151260504201680672268907563
0.00602240896358543417366946778711
0.00462184873949579831932773109243
0.00490196078431372549019607843137
0.00392156862745098039215686274510
0.00560224089635854341736694677871
0.00546218487394957983193277310924
0.00392156862745098039215686274510
0.00378151260504201680672268907563
0.00434173669467787114845938375350
0.00364145658263305322128851540616
0.00490196078431372549019607843137
0.00434173669467787114845938375350
0.00490196078431372549019607843137
0.00448179271708683473389355742297
0.00546218487394957983193277310924
0.00518207282913165266106442577031
0.00406162464985994397759103641456
0.00652072659524918490917559385189
0.00434715106349945660611706256792
0.00683123738549914609532681260674
0.00434715106349945660611706256792
0.00481291724887439838534389070020
0.00605496040987424312994876571961
0.00419189566837447601304145319050
0.00434715106349945660611706256792
0.00357087408787455364073901568080
0.00465766185374941779226828132278
0.00450240645862443719919267194535
0.00403664027324949541996584381307
0.00388138487812451482689023443565
0.00465766185374941779226828132278
0.00434715106349945660611706256792
0.00372612948299953423381462505822
0.00589970501474926253687315634218
0.00543393882937432075764632820991
0.00512342803912435957149510945505
> /*
> I see some 0.093's there. But I should have printed out m and i
> at each stage; so let's do it again a bit better!
> */
> for m:=2 to 20 do
for> for i:=2 to m do
for|for> "m=",m,"i=",i,CoincidenceIndex(Decimation(sct7,[1,i],m));
for|for> end for;
for> end for;
m= 2 i= 2 0.00535102934788221963674363359650
m= 3 i= 2 0.00554015672586661191527221708928
m= 3 i= 3 0.00426034288060774047839030900318
m= 4 i= 2 0.00532073383561060741497467330694
m= 4 i= 3 0.00432347629385044785376799168141
m= 4 i= 4 0.00489507512876175882177669944239
m= 5 i= 2 0.00582241630276564774381368267831
m= 5 i= 3 0.00440486723558904396304858673212
m= 5 i= 4 0.00453805976539087250620772326398
m= 5 i= 5 0.00412896842385668483793323248756
m= 6 i= 2 0.00535927773426227480727212763326
m= 6 i= 3 0.00410877959626774401890863118550
m= 6 i= 4 0.00457599868079317310467081667148
m= 6 i= 5 0.00425993871184950048783169119567
m= 6 i= 6 0.00395762048068598754998557117533
m= 7 i= 2 0.00939807563213246811367196240770
m= 7 i= 3 0.00934213470575072723204296263146
m= 7 i= 4 0.00749608413515327813828597001566
m= 7 i= 5 0.00453121503692101141194898187514
m= 7 i= 6 0.00488550757067203699559931379130
m= 7 i= 7 0.00585515029462221227716864324607
m= 8 i= 2 0.00579907896981067712775029848200
m= 8 i= 3 0.00438585804439462976048341902000
m= 8 i= 4 0.00494627323895616578543407811701
m= 8 i= 5 0.00382544284983309373553275992300
m= 8 i= 6 0.00480007797080967812675129748300
m= 8 i= 7 0.00428839453229697132136156526400
m= 8 i= 8 0.00460515094661436124850758997101
m= 9 i= 2 0.00626833410529566157171530029335
m= 9 i= 3 0.00441562451752354485101127065000
m= 9 i= 4 0.00463177396943029180176007410838
m= 9 i= 5 0.00450825999691215068704647213216
m= 9 i= 6 0.00361278369615562760537285780454
m= 9 i= 7 0.00463177396943029180176007410838
m= 9 i= 8 0.00444650301065308012968967114405
m= 9 i= 9 0.00426123205187586845761926817971
m= 10 i= 2 0.00601394315483030720907071171378
m= 10 i= 3 0.00402206389335784877039760974488
m= 10 i= 4 0.00490308741285528231057994330805
m= 10 i= 5 0.00352409407798973416072933425266
m= 10 i= 6 0.00482647667202941852447713169386
m= 10 i= 7 0.00452003370872596338006588523711
m= 10 i= 8 0.00425189611583544012870604458745
m= 10 i= 9 0.00402206389335784877039760974488
m= 10 i= 10 0.00363901018922852983988355167395
m= 11 i= 2 0.00594574507617985878855444072835
m= 11 i= 3 0.00459866220735785953177257525083
m= 11 i= 4 0.00431995540691192865105908584169
m= 11 i= 5 0.00455221107395020438498699368265
m= 11 i= 6 0.00483091787439613526570048309178
m= 11 i= 7 0.00478446674098848011891490152360
m= 11 i= 8 0.00422705314009661835748792270532
m= 11 i= 9 0.00380899293942772203641768859160
m= 11 i= 10 0.00348383500557413600891861761427
m= 11 i= 11 0.00510962467484206614641397250093
m= 12 i= 2 0.00507026729126481124276660236980
m= 12 i= 3 0.00473959768531275833562965004133
m= 12 i= 4 0.00484982088729677597134196748415
m= 12 i= 5 0.00507026729126481124276660236980
m= 12 i= 6 0.00512537889225682006062276109121
m= 12 i= 7 0.00429870487737668779278038027005
m= 12 i= 8 0.00545604849820887296775971341968
m= 12 i= 9 0.00363736566547258197850647561312
m= 12 i= 10 0.00589694130614494351060898319096
m= 12 i= 11 0.00440892807936070542849269771287
m= 12 i= 12 0.00540093689721686414990355469826
m= 13 i= 2 0.00512987012987012987012987012987
m= 13 i= 3 0.00370129870129870129870129870130
m= 13 i= 4 0.00584415584415584415584415584416
m= 13 i= 5 0.00441558441558441558441558441558
m= 13 i= 6 0.00441558441558441558441558441558
m= 13 i= 7 0.00474025974025974025974025974026
m= 13 i= 8 0.00590909090909090909090909090909
m= 13 i= 9 0.00363636363636363636363636363636
m= 13 i= 10 0.00441558441558441558441558441558
m= 13 i= 11 0.00383116883116883116883116883117
m= 13 i= 12 0.00396103896103896103896103896104
m= 13 i= 13 0.00487012987012987012987012987013
m= 14 i= 2 0.0108484213676492593146790363609
m= 14 i= 3 0.00830465359868322609606464162801
m= 14 i= 4 0.00950172078407900643423612150231
m= 14 i= 5 0.00546161903336824779290737692653
m= 14 i= 6 0.00471345204249588508155020200509
m= 14 i= 7 0.00546161903336824779290737692653
m= 14 i= 8 0.00418973514888523118360017956008
m= 14 i= 9 0.00448900194523417626814304952866
m= 14 i= 10 0.00389046835253628609905730959150
m= 14 i= 11 0.00441418524614693999700733203651
m= 14 i= 12 0.00404010175071075864132874457579
m= 14 i= 13 0.00553643573245548406404309441868
m= 14 i= 14 0.00463863534340864881041448451294
m= 15 i= 2 0.00593395252837977296181630546955
m= 15 i= 3 0.00343997248022015823873409012728
m= 15 i= 4 0.00498796009631922944616443068456
m= 15 i= 5 0.00352597179222566219470244238046
m= 15 i= 6 0.00412796697626418988648090815273
m= 15 i= 7 0.00472996216030271757825937392501
m= 15 i= 8 0.00455796353629170966632266941865
m= 15 i= 9 0.00464396284829721362229102167182
m= 15 i= 10 0.00395596835225318197454420364637
m= 15 i= 11 0.00464396284829721362229102167182
m= 15 i= 12 0.00524595803233574131406948744410
m= 15 i= 13 0.00472996216030271757825937392501
m= 15 i= 14 0.00421396628826969384244926040592
m= 15 i= 15 0.00447196422428620571035431716546
m= 16 i= 2 0.00689451393676745789421845759874
m= 16 i= 3 0.00364424308086279917265832758791
m= 16 i= 4 0.00443218753077908007485472274205
m= 16 i= 5 0.00344725696838372894710922879937
m= 16 i= 6 0.00492465281197675563872746971339
m= 16 i= 7 0.00453068058701861518762927213631
m= 16 i= 8 0.00443218753077908007485472274205
m= 16 i= 9 0.00502314586821629075150201910765
m= 16 i= 10 0.00393972224958140451098197577071
m= 16 i= 11 0.00413670836206047473653107455924
m= 16 i= 12 0.00472766669949768541317837092485
m= 16 i= 13 0.00443218753077908007485472274205
m= 16 i= 14 0.00374273613710233428543287698217
m= 16 i= 15 0.00610656948685117699202206244460
m= 16 i= 16 0.00551561114941396631537476607899
m= 17 i= 2 0.00619126589275843007186290768381
m= 17 i= 3 0.00287451630735212824765063571034
m= 17 i= 4 0.00386954118297401879491431730238
m= 17 i= 5 0.00508568269762299613045881702598
m= 17 i= 6 0.00409065782200110558319513543394
m= 17 i= 7 0.00420121614151464897733554449973
m= 17 i= 8 0.00530679933665008291873963515754
m= 17 i= 9 0.00420121614151464897733554449973
m= 17 i= 10 0.00552791597567716970702045328911
m= 17 i= 11 0.00386954118297401879491431730238
m= 17 i= 12 0.00276395798783858485351022664456
m= 17 i= 13 0.00552791597567716970702045328911
m= 17 i= 14 0.00353786622443338861249309010503
m= 17 i= 15 0.00420121614151464897733554449973
m= 17 i= 16 0.00508568269762299613045881702598
m= 17 i= 17 0.00353786622443338861249309010503
m= 18 i= 2 0.00549931258592675915510561179853
m= 18 i= 3 0.00424946881639795025621797275341
m= 18 i= 4 0.00562429696287964004499437570304
m= 18 i= 5 0.00449943757030371203599550056243
m= 18 i= 6 0.00324959380077490313710786151731
m= 18 i= 7 0.00449943757030371203599550056243
m= 18 i= 8 0.00462442194725659292588426446694
m= 18 i= 9 0.00287464066991626046744156980377
m= 18 i= 10 0.00449943757030371203599550056243
m= 18 i= 11 0.00387451568553930758655168103987
m= 18 i= 12 0.00437445319335083114610673665792
m= 18 i= 13 0.00412448443944506936632920884890
m= 18 i= 14 0.00437445319335083114610673665792
m= 18 i= 15 0.00312460942382202224721909761280
m= 18 i= 16 0.00424946881639795025621797275341
m= 18 i= 17 0.00587426571678540182477190351206
m= 18 i= 18 0.00437445319335083114610673665792
m= 19 i= 2 0.00378151260504201680672268907563
m= 19 i= 3 0.00602240896358543417366946778711
m= 19 i= 4 0.00462184873949579831932773109243
m= 19 i= 5 0.00490196078431372549019607843137
m= 19 i= 6 0.00392156862745098039215686274510
m= 19 i= 7 0.00560224089635854341736694677871
m= 19 i= 8 0.00546218487394957983193277310924
m= 19 i= 9 0.00392156862745098039215686274510
m= 19 i= 10 0.00378151260504201680672268907563
m= 19 i= 11 0.00434173669467787114845938375350
m= 19 i= 12 0.00364145658263305322128851540616
m= 19 i= 13 0.00490196078431372549019607843137
m= 19 i= 14 0.00434173669467787114845938375350
m= 19 i= 15 0.00490196078431372549019607843137
m= 19 i= 16 0.00448179271708683473389355742297
m= 19 i= 17 0.00546218487394957983193277310924
m= 19 i= 18 0.00518207282913165266106442577031
m= 19 i= 19 0.00406162464985994397759103641456
m= 20 i= 2 0.00652072659524918490917559385189
m= 20 i= 3 0.00434715106349945660611706256792
m= 20 i= 4 0.00683123738549914609532681260674
m= 20 i= 5 0.00434715106349945660611706256792
m= 20 i= 6 0.00481291724887439838534389070020
m= 20 i= 7 0.00605496040987424312994876571961
m= 20 i= 8 0.00419189566837447601304145319050
m= 20 i= 9 0.00434715106349945660611706256792
m= 20 i= 10 0.00357087408787455364073901568080
m= 20 i= 11 0.00465766185374941779226828132278
m= 20 i= 12 0.00450240645862443719919267194535
m= 20 i= 13 0.00403664027324949541996584381307
m= 20 i= 14 0.00388138487812451482689023443565
m= 20 i= 15 0.00465766185374941779226828132278
m= 20 i= 16 0.00434715106349945660611706256792
m= 20 i= 17 0.00372612948299953423381462505822
m= 20 i= 18 0.00589970501474926253687315634218
m= 20 i= 19 0.00543393882937432075764632820991
m= 20 i= 20 0.00512342803912435957149510945505
> /*
> So I think that the block length m is 7. Note that this also causes there
> to be high values when m=14.
> */
> for j:=1 to 6 do
for> for i:=j+1 to 7 do
for|for> j,i,": CI=",CoincidenceIndex(Decimation(sct7,[j,i],7));
for|for> end for;
for> end for;
1 2 : CI= 0.00939807563213246811367196240770
1 3 : CI= 0.00934213470575072723204296263146
1 4 : CI= 0.00749608413515327813828597001566
1 5 : CI= 0.00453121503692101141194898187514
1 6 : CI= 0.00488550757067203699559931379130
1 7 : CI= 0.00585515029462221227716864324607
2 3 : CI= 0.00738420228238979637502797046319
2 4 : CI= 0.00842843290818229283210263295293
2 5 : CI= 0.00551950473633176698739464458865
2 6 : CI= 0.00443798015961810994256731558141
2 7 : CI= 0.00520250615350190199149697918997
3 4 : CI= 0.00509062430073842022823897963750
3 5 : CI= 0.00427015738047288729768031625270
3 6 : CI= 0.00639591258297904079958230774968
3 7 : CI= 0.0101439546505556798687252927575
4 5 : CI= 0.0109457745953606325054076228836
4 6 : CI= 0.00484821361975087640784664727381
4 7 : CI= 0.00501603639889609905273364660252
5 6 : CI= 0.00413962855224882524054598344148
5 7 : CI= 0.00410233460132766465279331692400
6 7 : CI= 0.00846572685910345341985529947043
> /*
> Likely adjacencies: (1,2),(1,3),(2,7),(2,8),(3,7),(4,5),(6,7).
> (1,2),(1,3),(2,4),(3,7),(4,5),(6,7). This gives the order
> 6731245 or its reverse.
> */
> T2:=TranspositionCryptosystem(7);
> key2:=T2![6,7,3,1,2,4,5];
> Enciphering(key2,Encoding(T2,sct7));
NOWTHISISTHENEXTTALEANDITTELLSHOWTHECAMELGOTHISBIGHUMPINTHEBEGINNINGOFYEARSWHENTHEWORLDWA\
SSONEWANDALLANDTHEANIMALSWEREJUSTBEGINNINGTOWORKFORMANTHEREWASACAMELANDHELIVEDINTHEMIDDLE\
OFAHOWLINGDESERTBECAUSEHEDIDNOTWANTTOWORKANDBESIDESHEWASAHOWLERHIMSELFSOHEATESTICKSANDTHO\
RNSANDTAMARISKSANDMILKWEEDANDPRICKLESMOSTSCRUCIATINGIDLEANDWHENANYBODYSPOKETOHIMHESAIDHUM\
PHJUSTHUMPHANDNOMOREPRESENTLYTHEHORSECAMETOHIMONMONDAYMORNINGWITHASADDLEONHISBACKANDABITI\
NHISMOUTHANDSAIDCAMELOCAMELCOMEOUTANDTROTLIKETHERESTOFUSHUMPHSAIDTHECAMELANDTHEHORSEWENTA\
WAYANDTOLDTHEMANPRESENTLYTHEDOGCAMETOHIMWITHASTICKINHISMOUTHANDSAIDCAMELOCAMELCOMEANDFETC\
HANDCARRYLIKETHERESTOFUSHUMPHSAIDTHECAMELANDTHEDOGWENTAWAYANDTOLDTHEMANPRESENTLYTHEOXCAME\
TOHIMWITHTHEYOKEONHISNECKANDSAIDCAMELOCAMELCOMEANDPLOUGHLIKETHERESTOFUSHUMPHSAIDTHECAMELA\
NDTHEOXWENTAWAYANDTOLDTHEMANATTHEENDOFTHEDAYTHEMANCALLEDTHEHORSEANDTHEDOGANDTHEOXTOGETHER\
ANDSAIDTHREEOTHREEIMVERYSORRYFORYOUWITHTHEWORLDSONEWANDALLBUTTHATHUMPHTHINGINTHEDESERTCAN\
TWORKORHEWOULDHAVEBEENHEREBYNOWSOIAMGOINGTOLEAVEHIMALONEANDYOUMUSTWORKDOUBLETIMETOMAKEUPF\
ORITTHATMADETHETHREEVERYANGRYWITHTHEWORLDSONEWANDALLANDTHEYHELDAPALAVERANDANINDABAANDAPUN\
CHAYETANDAPOWWOWONTHEEDGEOFTHEDESERTANDTHECAMELCAMECHEWINGONMILKWEEDMOSTSCRUCIATINGIDLEAN\
DLAUGHEDATTHEMTHENHESAIDHUMPHANDWENTAWAYAGAINPRESENTLYTHERECAMEALONGTHEDJINNINCHARGEOFALL\
DESERTSROLLINGINACLOUDOFDUSTDJINNSALWAYSTRAVELTHATWAYBECAUSEITISMAGICANDHESTOPPEDTOPALAVE\
RANDPOWPOWWITHTHETHREEDJINNOFALLDESERTSSAIDTHEHORSEISITRIGHTFORANYONETOBEIDLEWITHTHEWORLD\
SONEWANDALLCERTAINLYNOTSAIDTHEDJINNWELLSAIDTHEHORSETHERESATHINGINTHEMIDDLEOFYOURHOWLINGDE\
SERTANDHESAHOWLERHIMSELFWITHALONGNECKANDLONGLEGSANDHEHASNTDONEASTROKEOFWORKSINCEMONDAYMOR\
NINGHEWONTTROTWHEWSAIDTHEDJINNWHISTLINGTHATSMYCAMELFORALLTHEGOLDINARABIAWHATDOESHESAYABOU\
TITHESAYSHUMPHSAIDTHEDOGANDHEWONTFETCHANDCARRYDOESHESAYANYTHINGELSEONLYHUMPHANDHEWONTPLOU\
GHSAIDTHEOXVERYGOODSAIDTHEDJINNILLHUMPHHIMIFYOUWILLKINDLYWAITAMINUTETHEDJINNROLLEDHIMSELF\
UPINHISDUSTCLOAKANDTOOKABEARINGACROSSTHEDESERTANDFOUNDTHECAMELMOSTSCRUCIATINGLYIDLELOOKIN\
GATHISOWNREFLECTIONINAPOOLOFWATERMYLONGANDBUBBLINGFRIENDSAIDTHEDJINNWHATSTHISIHEAROFYOURD\
OINGNOWORKWITHTHEWORLDSONEWANDALLHUMPHSAIDTHECAMELTHEDJINNSATDOWNWITHHISCHININHISHANDANDB\
EGANTOTHINKAGREATMAGICWHILETHECAMELLOOKEDATHISOWNREFLECTIONINTHEPOOLOFW
> /*
> How the Camel got his Hump" by Rudyard Kipling.
> */
> /*
> The substitution ciphers (ct1, ct4) are easy now that we
> have got a tailor-made magma function for cracking
> substitution ciphers.
> */
> bk:=BestSubstitutionKey(ct1);
For typical unenciphered text, you can expect the score divided by the length to
be at least 2.
In this case, using a key based solely on letter frequencies, the score divided 
by length was 0.397473275024295432458697764820
Print this text? (y/n):
n
Should I try to find a better key? (y/n)
y
Starting with a key based on standard letter frequencies.
The score is 1636
Trying to improve it ...
2682
3404
3476
3864
4870
4900
4926
4948
5504
5724
5862
5890
7870
10214
10692
Pass number 1 completed. Trying again ...
12180
Pass number 2 completed. Trying again ...
That's the best I can do!
New best score is 12180
Score divided by length is 2.95918367346938775510204081633
Print deciphered text? (y/n):
y
ITWASTERRIBLYCOLDANDNEARLYDARKONTHELASTEVENINGOFTHEOLDYEARANDTHESNOWWASFALLINGF\
ASTINTHECOLDANDTHEDARKNESSAPOORLITTLEGIRLWITHBAREHEADANDNAKEDFEETROAMEDTHROUGHT\
HESTREETSITISTRUESHEHADONAPAIROFSLIPPERSWHENSHELEFTHOMEBUTTHEYWERENOTOFMUCHUSET\
HEYWEREVERYLARGESOLARGEINDEEDTHATTHEYHADBELONGEDTOHERMOTHERANDTHEPOORLITTLECREA\
TUREHADLOSTTHEMINRUNNINGACROSSTHESTREETTOAVOIDTWOCARRIAGESTHATWEREROLLINGALONGA\
TATERRIBLERATEONEOFTHESLIPPERSSHECOULDNOTFINDANDABOYSEIXEDUPONTHEOTHERANDRANAWA\
YWITHITSAYINGTHATHECOULDUSEITASACRADLEWHENHEHADCHILDRENOFHISOWNSOTHELITTLEGIRLW\
ENTONWITHHERLITTLENAKEDFEETWHICHWEREQUITEREDANDBLUEWITHTHECOLDINANOLDAPRONSHECA\
RRIEDANUMBEROFMATCHESANDHADABUNDLEOFTHEMINHERHANDSNOONEHADBOUGHTANYTHINGOFHERTH\
EWHOLEDAYNORHADANYONEGIVENHEREVENAPENNYSHIVERINGWITHCOLDANDHUNGERSHECREPTALONGP\
OORLITTLECHILDSHELOOKEDTHEPICTUREOFMISERYTHESNOWFLAKESFELLONHERLONGFAIRHAIRWHIC\
HHUNGINCURLSONHERSHOULDERSBUTSHEREGARDEDTHEMNOTLIGHTSWERESHININGFROMEVERYWINDOW\
ANDTHEREWASASAVORYSMELLOFROASTGOOSEFORITWASNEWYEARSEVEYESSHEREMEMBEREDTHATINACO\
RNERBETWEENTWOHOUSESONEOFWHICHPROJECTEDBEYONDTHEOTHERSHESANKDOWNANDHUDDLEDHERSE\
LFTOGETHERSHEHADDRAWNHERLITTLEFEETUNDERHERBUTSHECOULDNOTKEEPOFFTHECOLDANDSHEDAR\
EDNOTGOHOMEFORSHEHADSOLDNOMATCHESANDCOULDNOTTAKEHOMEEVENAPENNYOFMONEYHERFATHERW\
OULDCERTAINLYBEATHERBESIDESITWASALMOSTASCOLDATHOMEASHEREFORTHEYHADONLYTHEROOFTO\
COVERTHEMTHROUGHWHICHTHEWINDHOWLEDALTHOUGHTHELARGESTHOLESHADBEENSTOPPEDUPWITHST\
RAWANDRAGSHERLITTLEHANDSWEREALMOSTFROXENWITHTHECOLDAHPERHAPSABURNINGMATCHMIGHTB\
ESOMEGOODIFSHECOULDDRAWITFROMTHEBUNDLEANDSTRIKEITAGAINSTTHEWALLJUSTTOWARMHERFIN\
GERSSHEDREWONEOUTSCRATCHHOWITSPUTTEREDASITBURNTITGAVEAWARMBRIGHTLIGHTLIKEALITTL\
ECANDLEASSHEHELDHERHANDOVERITITWASREALLYAWONDERFULLIGHTITSEEMEDTOTHELITTLEGIRLT\
HATSHEWASSITTINGBYALARGEIRONSTOVEWITHPOLISHEDBRASSFEETANDABRASSORNAMENTHOWTHEFI\
REBURNEDANDSEEMEDSOBEAUTIFULLYWARMTHATTHECHILDSTRETCHEDOUTHERFEETASIFTOWARMTHEM\
WHENLOTHEFLAMEOFTHEMATCHWENTOUTTHESTOVEVANISHEDANDSHEHADONLYTHEREMAINSOFTHEHALF\
BURNTMATCHINHERHANDSHERUBBEDANOTHERMATCHONTHEWALLITBURSTINTOAFLAMEANDWHEREITSLI\
GHTFELLUPONTHEWALLITBECAMEASTRANSPARENTASAVEILANDSHECOULDSEEINTOTHEROOMTHETABLE\
WASCOVEREDWITHASNOWYWHITETABLECLOTHONWHICHSTOODASPLENDIDDINNERSERVICEANDASTEAMI\
NGROASTGOOSESTUFFEDWITHAPPLESANDDRIEDPLUMSANDWHATWASSTILLMOREWONDERFULTHEGOOSEJ\
UMPEDDOWNFROMTHEDISHANDWADDLEDACROSSTHEFLOORWITHAKNIFEANDFORKINITSBREASTTOTHELI\
TTLEGIRLTHENTHEMATCHWENTOUTANDTHEREREMAINEDNOTHINGBUTTHETHICKDAMPCOLDWALLBEFORE\
HERSHELIGHTEDANOTHERMATCHANDTHENSHEFOUNDHERSELFSITTINGUNDERABEAUTIFULCHRISTMAST\
REEITWASLARGERANDMOREBEAUTIFULLYDECORATEDTHANTHEONEWHICHSHEHADSEENTHROUGHTHEGLA\
SSDOORATTHERICHMERCHANTSTHOUSANDSOFTAPERSWEREBURNINGUPONTHEGREENBRANCHESANDCOLO\
REDPICTURESLIKETHOSESHEHADSEENINTHESHOWWINDOWSLOOKEDDOWNUPONITALLTHELITTLEONEST\
RETCHEDOUTHERHANDTOWARDSTHEMANDTHEMATCHWENTOUTTHECHRISTMASLIGHTSROSEHIGHERANDHI\
GHERTILLTHEYLOOKEDTOHERLIKETHESTARSINTHESKYTHENSHESAWASTARFALLLEAVINGBEHINDITAB\
RIGHTSTREAKOFFIRESOMEONEISDYINGTHOUGHTTHELITTLEGIRLFORHEROLDGRANDMOTHERTHEONLYO\
NEWHOHADEVERLOVEDHERANDWHOWASNOWDEADHADTOLDHERTHATWHENASTARFALLSASOULWASGOINGUP\
TOGODSHEAGAINRUBBEDAMATCHONTHEWALLANDTHELIGHTSHONEROUNDHERINTHEBRIGHTNESSSTOODH\
EROLDGRANDMOTHERCLEARANDSHININGYETMILDANDLOVINGINHERAPPEARANCEGRANDMOTHERCRIEDT\
HELITTLEONEOTAKEMEWITHYOUIKNOWYOUWILLGOAWAYWHENTHEMATCHBURNSOUTYOUWILLVANISHLIK\
ETHEWARMSTOVETHEROASTGOOSEANDTHELARGEGLORIOUSCHRISTMASTREEANDSHEMADEHASTETOLIGH\
TTHEWHOLEBUNDLEOFMATCHESFORSHEWISHEDTOKEEPHERGRANDMOTHERTHEREANDTHEMATCHESGLOWE\
DWITHALIGHTTHATWASBRIGHTERTHANTHENOONDAYANDHERGRANDMOTHERHADNEVERAPPEAREDSOLARG\
EORSOBEAUTIFULSHETOOKTHELITTLEGIRLINHERARMSANDTHEYBOTHFLEWUPWARDSINBRIGHTNESSAN\
DJOYFARABOVETHEEARTHWHERETHEREWASNEITHERCOLDNORHUNGERNORPAINFORTHEYWEREWITHGODI\
NTHEDAWNOFMORNINGTHERELAYTHEPOORLITTLEONEWITHPALECHEEKSANDSMILINGMOUTHLEANINGAG\
AINSTTHEWALLSHEHADBEENFROXENTODEATHONTHELASTEVENINGOFTHEYEARANDTHENEWYEARSSUNRO\
SEANDSHONEUPONALITTLECORPSETHECHILDSTILLSATINTHESTIFFNESSOFDEATHHOLDINGTHEMATCH\
ESINHERHANDONEBUNDLEOFWHICHWASBURNTSHETRIEDTOWARMHERSELFSAIDSOMENOONEIMAGINEDWH\
ATBEAUTIFULTHINGSSHEHADSEENNORINTOWHATGLORYSHEHADENTEREDWITHHERGRANDMOTHERONNEW\
YEARSDAY
Try again? (y/n)
n
> bk;
KSIZUMLBEJXNWGTOPCVYDRQHFA
> /*
> It is possible that we haven't got exactly the right substitution key.
> A couple of really uncommon letters, like Z and Q, might be swapped.
> But I can't bear to read all the story to see if there is anything to fix!
> */
> bk:=BestSubstitutionKey(ct4);
For typical unenciphered text, you can expect the score divided by the length to
be at least 2.
In this case, using a key based solely on letter frequencies, the score divided 
by length was 0.557815986349914686966793542460
Print this text? (y/n):
n
Should I try to find a better key? (y/n)
y
Starting with a key based on standard letter frequencies.
The score is 4250
Trying to improve it ...
5052
5248
7732
7898
11874
12494
12510
12648
12976
13420
15418
16558
17562
20072
20504
Pass number 1 completed. Trying again ...
That's the best I can do!
New best score is 20504
Score divided by length is 2.69116681979262370389814936343
Print deciphered text? (y/n):
y
ADUCKONCEARRIVEDFROMPORTUGALBUTTHEREWERESOMEWHOSAIDSHECAMEFROMSPAINWHICHISALMOS\
TTHESAMETHINGATALLEVENTSSHEWASCALLEDTHEPORTUGUESEANDSHELAIDEGGSWASKILLEDANDCOOK\
EDANDTHEREWASANENDOFHERBUTTHEDUCKLINGSWHICHCREPTFORTHFROMTHEEGGSWEREALSOCALLEDP\
ORTUGUESEANDABOUTTHATTHEREMAYBESOMEQUESTIONBUTOFALLTHEFAMILYONEONLYREMAINEDINTH\
EDUCKYARDWHICHMAYBECALLEDAFARMYARDASTHECHICKENSWEREADMITTEDANDTHECOCKSTRUTTEDAB\
OUTINAVERYHOSTILEMANNERHEANNOYSMEWITHHISLOUDCROWINGSAIDTHEPORTUGUESEDUCKBUTSTIL\
LHESAHANDSOMEBIRDTHERESNODENYINGTHATALTHOUGHHESNOTADRAKEHEOUGHTTOMODERATEHISVOI\
CELIKETHOSELITTLEBIRDSWHOARESINGINGINTHELIMETREESOVERTHEREINOURNEIGHBORSGARDENB\
UTTHATISANARTONLYACQUIREDINPOLITESOCIETYHOWSWEETLYTHEYSINGTHEREITISQUITEAPLEASU\
RETOLISTENTOTHEMICALLITPORTUGUESESINGINGIFIHADONLYSUCHALITTLESINGINGBIRDIDBEKIN\
DANDGOODASAMOTHERTOHIMFORITSINMYNATUREINMYPORTUGUESEBLOODWHILESHEWASSPEAKINGONE\
OFTHELITTLESINGINGBIRDSCAMETUMBLINGHEADOVERHEELSFROMTHEROOFINTOTHEYARDTHECATWAS\
AFTERHIMBUTHEHADESCAPEDFROMHERWITHABROKENWINGANDSOCAMETUMBLINGINTOTHEYARDTHATSJ\
USTLIKETHECATSHESAVILLAINSAIDTHEPORTUGUESEDUCKIREMEMBERHERWAYSWHENIHADCHILDRENO\
FMYOWNHOWCANSUCHACREATUREBEALLOWEDTOLIVEANDWANDERABOUTUPONTHEROOFSIDONTTHINKTHE\
YALLOWSUCHTHINGSINPORTUGALSHEPITIEDTHELITTLESINGINGBIRDANDSODIDALLTHEOTHERDUCKS\
WHOWERENOTPORTUGUESEPOORLITTLECREATURETHEYSAIDONEAFTERANOTHERASTHEYCAMEUPWECANT\
SINGCERTAINLYBUTWEHAVEASOUNDINGBOARDORSOMETHINGOFTHEKINDWITHINUSWECANFEELTHATTH\
OUGHWEDONTTALKABOUTITBUTICANTALKSAIDTHEPORTUGUESEDUCKANDILLDOSOMETHINGFORTHELIT\
TLEFELLOWITSMYDUTYANDSHESTEPPEDINTOTHEWATERTROUGHANDBEATHERWINGSUPONTHEWATERSOS\
TRONGLYTHATTHEBIRDWASNEARLYDROWNEDBYASHOWERBATHBUTTHEDUCKMEANTITKINDLYTHATISAGO\
ODDEEDSHESAIDIHOPETHEOTHERSWILLTAKEEXAMPLEBYITTWEETTWEETSAIDTHELITTLEBIRDFORONE\
OFHISWINGSBEINGBROKENHEFOUNDITDIFFICULTTOSHAKEHIMSELFBUTHEQUITEUNDERSTOODTHATTH\
EBATHWASMEANTKINDLYANDHESAIDYOUAREVERYKINDHEARTEDMADAMBUTHEDIDNOTWISHFORASECOND\
BATHIHAVENEVERTHOUGHTABOUTMYHEARTREPLIEDTHEPORTUGUESEDUCKBUTIKNOWTHATILOVEALLMY\
FELLOWCREATURESEXCEPTTHECATANDNOBODYCANEXPECTMETOLOVEHERFORSHEATEUPTWOOFMYDUCKL\
INGSBUTPRAYMAKEYOURSELFATHOMEITISEASYTOMAKEONESSELFCOMFORTABLEIAMMYSELFFROMAFOR\
EIGNCOUNTRYASYOUMAYSEEBYMYFEATHERYDRESSMYDRAKEISANATIVEOFTHESEPARTSHESNOTOFMYRA\
CEBUTIAMNOTPROUDONTHATACCOUNTIFANYONEHERECANUNDERSTANDYOUIMAYSAYPOSITIVELYIAMTH\
ATPERSONSHESQUITEFULLOFPORTULAKSAIDALITTLECOMMONDUCKWHOWASWITTYALLTHECOMMONDUCK\
SCONSIDEREDTHEWORDPORTULAKAGOODJOKEFORITSOUNDEDLIKEPORTUGALTHEYNUDGEDEACHOTHERA\
NDSAIDQUACKTHATWASWITTYTHENTHEOTHERDUCKSBEGANTONOTICETHELITTLEBIRDTHEPORTUGUESE\
HADCERTAINLYAGREATFLOWOFLANGUAGETHEYSAIDTOTHELITTLEBIRDFOROURPARTWEDONTCARETOFI\
LLOURBEAKSWITHSUCHLONGWORDSBUTWESYMPATHIZEWITHYOUQUITEASMUCHIFWEDONTDOANYTHINGE\
LSEWECANWALKABOUTWITHYOUEVERYWHEREANDWETHINKTHATISTHEBESTTHINGWECANDOYOUHAVEALO\
VELYVOICESAIDONEOFTHEELDESTDUCKSITMUSTBEGREATSATISFACTIONTOYOUTOBEABLETOGIVESOM\
UCHPLEASUREASYOUDOIAMCERTAINLYNOJUDGEOFYOURSINGINGSOIKEEPMYBEAKSHUTWHICHISBETTE\
RTHANTALKINGNONSENSEASOTHERSDODONTPLAGUEHIMSOINTERPOSEDTHEPORTUGUESEDUCKHEREQUI\
RESRESTANDNURSINGMYLITTLESINGINGBIRDDOYOUWISHMETOPREPAREANOTHERBATHFORYOUOHNONO\
PRAYLETMEDRYIMPLOREDTHELITTLEBIRDTHEWATERCUREISTHEONLYREMEDYFORMEWHENIAMNOTWELL\
SAIDTHEPORTUGUESEAMUSEMENTTOOISVERYBENEFICIALTHEFOWLSFROMTHENEIGHBORHOODWILLSOO\
NBEHERETOPAYYOUAVISITTHEREARETWOCOCHINCHINESEAMONGSTTHEMTHEYWEARFEATHERSONTHEIR\
LEGSANDAREWELLEDUCATEDTHEYHAVEBEENBROUGHTFROMAGREATDISTANCEANDCONSEQUENTLYITREA\
TTHEMWITHGREATERRESPECTTHANIDOTHEOTHERSTHENTHEFOWLSARRIVEDANDTHECOCKWASPOLITEEN\
OUGHTODAYTOKEEPFROMBEINGRUDEYOUAREAREALSONGSTERHESAIDYOUDOASMUCHWITHYOURLITTLEV\
OICEASITISPOSSIBLETODOBUTTHEREREQUIRESMORENOISEANDSHRILLNESSINANYONEWHOWISHESIT\
TOBEKNOWNWHOHEISTHETWOCHINESEWEREQUITEENCHANTEDWITHTHEAPPEARANCEOFTHESINGINGBIR\
DHISFEATHERSHADBEENMUCHRUFFLEDBYHISBATHSOTHATHESEEMEDTOTHEMQUITELIKEATINYCHINES\
EFOWLHESCHARMINGTHEYSAIDTOEACHOTHERANDBEGANACONVERSATIONWITHHIMINWHISPERSUSINGT\
HEMOSTARISTOCRATICCHINESEDIALECTWEAREOFTHESAMERACEASYOURSELFTHEYSAIDTHEDUCKSEVE\
NTHEPORTUGUESEAREALLAQUATICBIRDSASYOUMUSTHAVENOTICEDYOUDONOTKNOWUSYETVERYFEWKNO\
WUSORGIVETHEMSELVESTHETROUBLETOMAKEOURACQUAINTANCENOTEVENANYOFTHEFOWLSTHOUGHWEA\
REBORNTOOCCUPYAHIGHERGRADEINSOCIETYTHANMOSTOFTHEMBUTTHATDOESNOTDISTURBUSWEQUIET\
LYGOONINOUROWNWAYAMONGTHERESTWHOSEIDEASARECERTAINLYNOTOURSFORWELOOKATTHEBRIGHTS\
IDEOFTHINGSANDONLYSPEAKWHATISGOODALTHOUGHTHATISSOMETIMESVERYDIFFICULTTOFINDWHER\
ENONEEXISTSEXCEPTOURSELVESANDTHECOCKTHEREISNOTONEINTHEYARDWHOCANBECALLEDTALENTE\
DORPOLITEITCANNOTEVENBESAIDOFTHEDUCKSANDWEWARNYOULITTLEBIRDNOTTOTRUSTTHATONEYON\
DERWITHTHESHORTTAILFEATHERSFORSHEISCUNNINGTHATCURIOUSLYMARKEDONEWITHTHECROOKEDS\
TRIPESONHERWINGSISAMISCHIEFMAKERANDNEVERLETSANYONEHAVETHELASTWORDTHOUGHSHEISALW\
AYSINTHEWRONGTHATFATDUCKYONDERSPEAKSEVILOFEVERYONEANDTHATISAGAINSTOURPRINCIPLES\
IFWEHAVENOTHINGGOODTOTELLWECLOSEOURBEAKSTHEPORTUGUESEISTHEONLYONEWHOHASHADANYED\
UCATIONANDWITHWHOMWECANASSOCIATEBUTSHEISPASSIONATEANDTALKSTOOMUCHABOUTPORTUGALI\
WONDERWHATTHOSETWOCHINESEAREWHISPERINGABOUTWHISPEREDONEDUCKTOANOTHERTHEYAREALWA\
YSDOINGITANDITANNOYSMEWENEVERSPEAKTOTHEMNOWTHEDRAKECAMEUPANDHETHOUGHTTHELITTLES\
INGINGBIRDWASASPARROWWELLIDONTUNDERSTANDTHEDIFFERENCEHESAIDITAPPEARSTOMEALLTHES\
AMEHESONLYAPLAYTHINGANDIFPEOPLEWILLHAVEPLAYTHINGSWHYLETTHEMISAYDONTTAKEANYNOTIC\
EOFWHATHESAYSWHISPEREDTHEPORTUGUESEHESVERYWELLINMATTERSOFBUSINESSANDWITHHIMBUSI\
NESSISPLACEDBEFOREEVERYTHINGBUTNOWISHALLLIEDOWNANDHAVEALITTLERESTITISADUTYWEOWE\
TOOURSELVESTHATWEMAYBENICEANDFATWHENWECOMETOBEEMBALMEDWITHSAGEANDONIONSANDAPPLE\
SSOSHELAIDHERSELFDOWNINTHESUNANDWINKEDWITHONEEYESHEHADAVERYCOMFORTABLEPLACEANDF\
ELTSOCOMFORTABLETHATSHEFELLASLEEPTHELITTLESINGINGBIRDBUSIEDHIMSELFFORSOMETIMEWI\
THHISBROKENWINGANDATLASTHELAYDOWNTOOQUITECLOSETOHISPROTECTRESSTHESUNSHONEWARMAN\
DBRIGHTANDHEFOUNDOUTTHATITWASAVERYGOODPLACEBUTTHEFOWLSOFTHENEIGHBORHOODWEREALLA\
WAKEANDTOTELLTHETRUTHTHEYHADPAIDAVISITTOTHEDUCKYARDSIMPLYANDSOLELYTOFINDFOODFOR\
THEMSELVESTHECHINESEWERETHEFIRSTTOLEAVEANDTHEOTHERFOWLSSOONFOLLOWEDTHEMTHEWITTY\
LITTLEDUCKSAIDOFTHEPORTUGUESETHATTHEOLDLADYWASGETTINGQUITEADOTINGDUCKYALLTHEOTH\
ERDUCKSLAUGHEDATTHISDOTINGDUCKYTHEYWHISPEREDOHTHATSTOOWITTYANDTHENTHEYREPEATEDT\
HEFORMERJOKEABOUTPORTULAKANDDECLAREDITWASMOSTAMUSINGTHENTHEYALLLAYDOWNTOHAVEANA\
PTHEYHADBEENLYINGASLEEPFORSOMETIMEWHENSUDDENLYSOMETHINGWASTHROWNINTOTHEYARDFORT\
HEMTOEATITCAMEDOWNWITHSUCHABANGTHATTHEWHOLECOMPANYSTARTEDUPANDCLAPPEDTHEIRWINGS\
THEPORTUGUESEAWOKETOOANDRUSHEDOVERTOTHEOTHERSIDEINSODOINGSHETRODUPONTHELITTLESI\
NGINGBIRDTWEETHECRIEDYOUTRODVERYHARDUPONMEMADAMWELLTHENWHYDOYOULIEINMYWAYSHERET\
ORTEDYOUMUSTNOTBESOTOUCHYIHAVENERVESOFMYOWNBUTIDONOTCRYTWEETDONTBEANGRYSAIDTHEL\
ITTLEBIRDTHETWEETSLIPPEDOUTOFMYBEAKUNAWARESTHEPORTUGUESEDIDNOTLISTENTOHIMBUTBEG\
ANEATINGASFASTASSHECOULDANDMADEAGOODMEALWHENSHEHADFINISHEDSHELAYDOWNAGAINANDTHE\
LITTLEBIRDWHOWISHEDTOBEAMIABLEBEGANTOSINGCHIRPANDTWITTERTHEDEWDROPSGLITTERINTHE\
HOURSOFSUNNYSPRINGILLSINGMYBESTTILLIGOTORESTWITHMYHEADBEHINDMYWINGNOWIWANTRESTA\
FTERMYDINNERSAIDTHEPORTUGUESEYOUMUSTCONFORMTOTHERULESOFTHEHOUSEWHILEYOUAREHEREI\
WANTTOSLEEPNOWTHELITTLEBIRDWASQUITETAKENABACKFORHEMEANTITKINDLYWHENMADAMAWOKEAF\
TERWARDSTHEREHESTOODBEFOREHERWITHALITTLECORNHEHADFOUNDANDLAIDITATHERFEETBUTASSH\
EHADNOTSLEPTWELLSHEWASNATURALLYINABADTEMPERGIVETHATTOACHICKENSHESAIDANDDONTBEAL\
WAYSSTANDINGINMYWAYWHYAREYOUANGRYWITHMEREPLIEDTHELITTLESINGINGBIRDWHATHAVEIDONE\
DONEREPEATEDTHEPORTUGUESEDUCKYOURMODEOFEXPRESSINGYOURSELFISNOTVERYPOLITEIMUSTCA\
LLYOURATTENTIONTOTHATFACTITWASSUNSHINEHEREYESTERDAYSAIDTHELITTLEBIRDBUTTODAYITI\
SCLOUDYANDTHEAIRISCLOSEYOUKNOWVERYLITTLEABOUTTHEWEATHERIFANCYSHERETORTEDTHEDAYI\
SNOTOVERYETDONTSTANDTHERELOOKINGSOSTUPIDBUTYOUARELOOKINGATMEJUSTASTHEWICKEDEYES\
LOOKEDWHENIFELLINTOTHEYARDYESTERDAY
Try again? (y/n)
n
> bk;
LXZDRSMCVTKNJYIFGPWAEQBOUH
> exit;